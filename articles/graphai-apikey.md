---
title: "GraphAIã§ã®APIKEYã®æ‰±ã„ã«ã¤ã„ã¦"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [agent, AI, LLM, Tech, GraphAI]
published: true
publication_name: "singularity"
---

:::message
GraphAIè¨˜äº‹ã®ä¸€è¦§ã¯[ã“ã¡ã‚‰](https://zenn.dev/singularity/articles/graphai-index)
:::


# APIã‚­ãƒ¼ç®¡ç†ã®é‡è¦æ€§

GraphAIã«é™ã‚‰ãšã€APIã‚­ãƒ¼ã®é©åˆ‡ãªç®¡ç†ã¯éå¸¸ã«é‡è¦ã§ã™ã€‚APIã‚­ãƒ¼ã«ã¯ **å…¬é–‹å¯èƒ½ãªã‚‚ã®** ã¨ **å…¬é–‹ã—ã¦ã¯ã„ã‘ãªã„ã‚‚ã®** ã®2ç¨®é¡ãŒã‚ã‚Šã¾ã™ã€‚

---

## å…¬é–‹å¯èƒ½ãªAPIã‚­ãƒ¼  
å…¬é–‹å¯èƒ½ãªAPIã‚­ãƒ¼ã¯Webã‚µã‚¤ãƒˆã«åŸ‹ã‚è¾¼ã‚“ã§ã‚‚å•é¡Œã®ãªã„ã‚­ãƒ¼ã§ã™ã€‚  
å…·ä½“ä¾‹ã¨ã—ã¦ä»¥ä¸‹ã®ã‚‚ã®ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ï¼š  
- Google Mapsã‚„Firebaseã®å…¬é–‹ã‚­ãƒ¼  
- Stripeã‚„Shopifyã®å…¬é–‹ã‚­ãƒ¼  

ã“ã‚Œã‚‰ã®ã‚­ãƒ¼ã¯å…¬é–‹ã•ã‚Œã¦ã„ã¦ã‚‚å®‰å…¨ãªç†ç”±ï¼š  
- **ãƒ–ãƒ©ã‚¦ã‚¶ã®Referreråˆ¶é™** ã«ã‚ˆã‚Šã‚¢ã‚¯ã‚»ã‚¹ç¯„å›²ã‚’åˆ¶é™ã§ãã‚‹  
- å˜ãªã‚‹ **è­˜åˆ¥å­** ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã€ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãè¾¼ã¿ãªã©ã®æ“ä½œãŒã§ããªã„  

---

## å…¬é–‹ã—ã¦ã¯ã„ã‘ãªã„APIã‚­ãƒ¼  
ä¸€æ–¹ã§ã€**Stripeã‚„Shopifyã®Secret Key** ãªã©ã€ä»–è€…ã«çµ¶å¯¾ã«è¦‹ã›ã¦ã¯ã„ã‘ãªã„APIã‚­ãƒ¼ã‚‚å­˜åœ¨ã—ã¾ã™ã€‚  
ã“ã‚Œã‚‰ãŒæ¼æ´©ã—ãŸå ´åˆã€ä»¥ä¸‹ã®å¯¾å¿œãŒå¿…è¦ã§ã™ï¼š  
- ã‚µãƒ¼ãƒ“ã‚¹ã®å³æ™‚åœæ­¢  
- APIã‚­ãƒ¼ã®ç„¡åŠ¹åŒ–ã¨æ–°ã—ã„ã‚­ãƒ¼ã¸ã®é€Ÿã‚„ã‹ãªæ›´æ–°  

---

## GraphAIã«ãŠã‘ã‚‹APIã‚­ãƒ¼ã®å–ã‚Šæ‰±ã„  

GraphAIã§ã¯ã€OpenAIã®Agentãªã©ã€APIã‚­ãƒ¼ãŒå¿…è¦ãªAgentãŒå­˜åœ¨ã—ã¾ã™ã€‚ã¾ãŸã€GraphAIã®Agentã¯ **ã‚µãƒ¼ãƒ** ã¨ **ãƒ–ãƒ©ã‚¦ã‚¶** ã®ä¸¡æ–¹ã§å‹•ä½œã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ï¼ˆæŠ€è¡“çš„åˆ¶ç´„ãŒãªã„é™ã‚Šï¼‰ã€‚  
ã“ã®ãŸã‚ã€APIã‚­ãƒ¼ã® **å…¬é–‹å¯å¦** ã¨ **GraphAIä¸Šã§ã®å®‰å…¨ãªå–ã‚Šæ‰±ã„** ã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚


### OpenAI Agentã®ä¾‹
GraphAIã®OpenAI Agentã§ã¯ã€ä»¥ä¸‹2ã¤ã®æ–¹æ³•ã§APIã‚­ãƒ¼ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ï¼š

-  **ç’°å¢ƒå¤‰æ•°** ã‚’åˆ©ç”¨ã—ã¦npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ç›´æ¥APIã‚­ãƒ¼ã‚’æ¸¡ã™ï¼ˆã‚µãƒ¼ãƒã®ã¿ï¼‰
-  **params** ã‚’æŒ‡å®šã—ã¦APIã‚­ãƒ¼ã‚’æ¸¡ã™ï¼ˆã‚µãƒ¼ãƒãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ä¸¡æ–¹ã§ä½¿ç”¨å¯èƒ½ï¼‰

```Javascript
{ params: { apiKey: "xxx" } }
```

---

## æ³¨æ„ç‚¹: ãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒã¨ç’°å¢ƒå¤‰æ•°  
Vueã‚„Reactã®CLIç’°å¢ƒã§ã¯ã€APIã‚­ãƒ¼ã‚’ç’°å¢ƒå¤‰æ•°ã«è¨­å®šã—ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã«æ¸¡ã™æ–¹æ³•ãŒä¸€èˆ¬çš„ã§ã™ãŒã€ä»¥ä¸‹ã«æ³¨æ„ãŒå¿…è¦ã§ã™ï¼š  
- **ç’°å¢ƒå¤‰æ•°ã¯ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã§ã®ã¿å®‰å…¨ã«æ‰±ãˆã‚‹** ã‚‚ã®ã§ã™ã€‚  
- ãƒ–ãƒ©ã‚¦ã‚¶å´ã«APIã‚­ãƒ¼ã‚’æ¸¡ã™ã¨ã€ãƒ“ãƒ«ãƒ‰å¾Œã®JavaScriptã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã—ã¾ã„ã€ã‚­ãƒ¼ãŒéœ²å‡ºã™ã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚  
  **ã“ã‚Œã¯ã€ã‚³ãƒ¼ãƒ‰ã«ç›´æ¥APIã‚­ãƒ¼ã‚’æ›¸ãè¾¼ã‚€ã®ã¨åŒã˜å±é™ºæ€§** ãŒã‚ã‚Šã¾ã™ã€‚  

---

## åˆ©ç”¨ã‚·ãƒŠãƒªã‚ªã”ã¨ã®APIã‚­ãƒ¼ç®¡ç†æ–¹æ³•  

### 1. é‹å–¶å´ã§ç”¨æ„ã—ãŸAPIã‚­ãƒ¼ã‚’ä½¿ã„ã€ä¸ç‰¹å®šå¤šæ•°ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ©ç”¨ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹  
- **ç’°å¢ƒå¤‰æ•°** ã‚’ä½¿ã„ã€ã‚µãƒ¼ãƒå´ã§APIã‚­ãƒ¼ã‚’ç®¡ç†ã—ã¾ã™ã€‚  
- APIã®åˆ©ç”¨æ–™é‡‘ã¯é‹å–¶å´ãŒè² æ‹…ã™ã‚‹ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®åˆ©ç”¨åˆ¶é™ã‚’æ¤œè¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  

### 2. ä¸ç‰¹å®šå¤šæ•°ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå€‹åˆ¥ã®APIã‚­ãƒ¼ã‚’ä½¿ã†Webã‚µãƒ¼ãƒ“ã‚¹  
- é‹å–¶å´ã¯APIã‚­ãƒ¼ã‚’ç”¨æ„ã›ãšã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å€‹åˆ¥ã®APIã‚­ãƒ¼ã‚’ç”¨æ„ã—ã¦ã‚‚ã‚‰ã„ã¾ã™ã€‚  
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã€**Local Storage** ãªã©ã«ä¿å­˜ã—ã¾ã™ã€‚  
- **ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ç›´æ¥OpenAIã¸ã‚¢ã‚¯ã‚»ã‚¹** ã™ã‚‹ãŸã‚ã€é‹å–¶å´ã®ã‚µãƒ¼ãƒã«ã¯APIã‚­ãƒ¼ã‚’ä¿å­˜ã—ã¾ã›ã‚“ã€‚  
  **ãƒ–ãƒ©ã‚¦ã‚¶å´ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒä¿ãŸã‚Œã¦ã„ã‚Œã°å®‰å…¨ã§ã™ã€‚**  

### 3. å€‹äººå‘ã‘ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚„é–‹ç™ºç’°å¢ƒï¼ˆReact/Vueã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§å‹•ä½œã•ã›ã‚‹å ´åˆï¼‰  
- **params** ã«ç›´æ¥APIã‚­ãƒ¼ã‚’åŸ‹ã‚è¾¼ã‚€æ–¹æ³•ãŒåˆ©ç”¨ã§ãã¾ã™ã€‚  
ãŸã ã—ã€**APIã‚­ãƒ¼ãŒã‚³ãƒ¼ãƒ‰ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã‚‹** ã“ã¨ã«ãªã‚‹ãŸã‚ã€ç¬¬ä¸‰è€…ã«æ¸¡ã‚‰ãªã„çŠ¶æ³ã§ã®ã¿ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚  

### 4. å€‹äººå‘ã‘ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆElectronãªã©ï¼‰  
- ã‚¢ãƒ—ãƒªã®è¨­å®šå€¤ã¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼è‡ªèº«ã«APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ã‚‚ã‚‰ã„ã¾ã™ï¼ˆã‚·ãƒŠãƒªã‚ª2ã¨åŒæ§˜ï¼‰ã€‚  
- **ã‚µãƒ¼ãƒ“ã‚¹é‹å–¶å´ãŒAPIã‚­ãƒ¼ã‚’æä¾›ã™ã‚‹å ´åˆ** ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ç•°ãªã‚‹APIã‚­ãƒ¼ã‚’ç™ºè¡Œã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚  
- APIã‚­ãƒ¼ãŒæµå‡ºã—ã¦ä»–ã§è»¢ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ã‚‚è€ƒæ…®ã—ã€é©åˆ‡ãªå¯¾ç­–ã‚’è¬›ã˜ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  

---

## ã¾ã¨ã‚  
APIã‚­ãƒ¼ç®¡ç†ã¯ã€ã‚·ãƒŠãƒªã‚ªã«å¿œã˜ã¦é©åˆ‡ãªæ–¹æ³•ã§å–ã‚Šæ‰±ã†ã“ã¨ãŒä¸å¯æ¬ ã§ã™ã€‚ç‰¹ã«ã€å…¬é–‹ãƒ»éå…¬é–‹ã®åŒºåˆ¥ã‚„åˆ©ç”¨è€…ã”ã¨ã®è²¬ä»»ç¯„å›²ã‚’æ˜ç¢ºã«ã—ã€å®‰å…¨ãªé‹ç”¨ã‚’å¾¹åº•ã—ã¾ã—ã‚‡ã†ã€‚


---

# The Importance of API Key Management

Proper management of API keys is crucial not only for GraphAI but for any service. API keys can be classified into two types: **publicly embeddable keys** and **keys that must remain private**.

---

## Publicly Embeddable API Keys  
Publicly embeddable API keys can be safely embedded in websites.  
Examples include:  
- Google Maps and Firebase keys  
- Stripe and Shopify public keys  

These keys are considered safe to expose because:  
- Access can be restricted using **browser referrer settings**.  
- They act as **identifiers only** and do not allow operations like data modification.  

---

## API Keys That Must Remain Private  
On the other hand, **Stripe's secret key** or **Shopify's secret key** are examples of API keys that must never be exposed.  
If these keys are leaked, the following actions are required:  
- Immediate suspension of the service  
- Revocation of the compromised API key and issuance of a new one  

---

## Handling API Keys in GraphAI  

In GraphAI, certain agents (e.g., OpenAI agents) require API keys to function.  
Agents in GraphAI can operate on both the **server** and **browser** unless there are specific technical constraints (e.g., accessing the file system).  
This dual functionality requires a clear understanding of:  
1. Whether an API key can be exposed.  
2. How API keys are managed within GraphAI.

---

## Key Management Methods in OpenAI Agents  

GraphAIâ€™s OpenAI agent supports the following two methods for passing API keys:  

1. Passing API keys via **environment variables** (server-side only).  
2. Passing API keys via **params** (usable on both server and browser).  

```Javascript
{ params: { apiKey: "xxx" } }
```
---

## Browser Environments and Environment Variables  
In CLI environments such as Vue or React, it is common to use environment variables to pass API keys to the browser. However, caution is required:  
- **Environment variables are safe only for server-side usage.**  
- When passing keys to the browser, they become embedded in the built JavaScript code.  
  **This is effectively the same as hardcoding the API key into the source code**, creating a significant exposure risk.  

---

## API Key Management Scenarios  

### 1. Service Using API Keys Provided by the Operator for Public Use  
- Use **environment variables** to manage the API key on the server side.  
- Since the service operator bears the API usage cost, consider implementing user-level usage limits.  

### 2. Public Web Services Where Users Provide Their Own API Keys  
- The operator does not provide API keys. Users must supply their own keys.  
- Users input their API key in the browser and store it in **Local Storage** or similar.  
- The browser directly accesses the API (e.g., OpenAI) without storing the API key on the server.  
  **This approach is safe as long as the browser's security is maintained.**  

### 3. Personal Software or Development Environments (Running React/Vue Locally)  
- Directly embed the API key in **params** or pass it via environment variables.  
- Note that embedding keys in code exposes them, so this method should only be used in isolated or personal environments.  

### 4. Desktop Applications for Personal Use (e.g., Electron)  
- Prompt users to input their API keys as application settings (similar to scenario 2).  
- **If the operator provides API keys**, generate unique keys for each user to mitigate unauthorized reuse.  
- Consider the risk of key leakage and implement proper safeguards where necessary.  

---

## Summary  
API key management must be tailored to each use case to ensure security.  
Clearly distinguish between keys that can be public and those that must remain private, and establish appropriate practices to manage and safeguard API keys effectively.
