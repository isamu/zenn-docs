---
title: "GraphAIã§è¤‡é›‘ãªä¾å­˜é–¢ä¿‚ã®ã‚ã‚‹ã‚¿ã‚¹ã‚¯ã‚’æœ€é©ãªé †ã«å®Ÿè¡Œã™ã‚‹"
emoji: "ğŸš€"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [nodejs, Async, GraphAI, gpt]
published: true
publication_name: "singularity"
---


## è¤‡é›‘ãªç•°å­˜ã®ã‚ã‚‹éåŒæœŸã‚¿ã‚¹ã‚¯

éåŒæœŸã¯é›£ã—ã„ã§ã™ã€‚éåŒæœŸã¯é›£ã—ã„ã§ã™ã€‚éåŒæœŸã¯é›£ã—ã„ã§ã™ã€‚

ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã¯ãªãæ—¥å¸¸ã®ã‚¿ã‚¹ã‚¯ã‚’ã‚µãƒ³ãƒ—ãƒ«ã«è€ƒãˆã¦ã¿ã¾ã™ã€‚

æœèµ·ãã¦ã‹ã‚‰å®¶ã‚’å‡ºã‚‹ã¾ã§ã®ã‚¿ã‚¹ã‚¯ä¾‹ã¨ã—ã¦æ›¸ãå‡ºã—ã¾ã™ã€‚
å·¦ã®()å†…ãŒã‚¿ã‚¹ã‚¯ã®id. å³ã®()ã¯ã€ä¾å­˜ã™ã‚‹ã‚¿ã‚¹ã‚¯idã¨ãã‚Œãã‚Œã®å®Ÿè¡Œã«ã‹ã‹ã‚‹æ™‚é–“ã§ã™ã€‚
ã‚³ãƒ¼ãƒ’ãƒ¼ã«ç€ç›®ã™ã‚‹ã¨ã€(1)ã§ãŠæ¹¯ã‚’æ²¸ã‹ã—ã€(5)ã§ãƒ‰ãƒªãƒƒãƒ—ã—ã€(10)ã§ã®ã¿çµ‚ãˆã€(11)ã§é£Ÿå™¨ã‚’æ´—ã„ã¾ã™ã€‚(8)ã®æœé£Ÿã‚‚(5)ã«ä¾å­˜ã—ã¦ã„ã¾ã™ã€‚
ã“ã®é †ç•ªã¯å…¥ã‚Œæ›¿ãˆã‚‹ã“ã¨ã‚‚ã§ãã¾ã›ã‚“ã—ã€å‰ã®ã‚¿ã‚¹ã‚¯ã®çµ‚äº†ã‚’å¾…ãŸãªã„ã¨æ¬¡ã®ã‚¿ã‚¹ã‚¯ã¯å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚ãŠæ¹¯ãŒæ¹§ã„ãŸã‚‰é©åˆ‡ãªæ¸©åº¦ã§ã™ãã«ãƒ‰ãƒªãƒƒãƒ—ã—ãŸã„ã§ã™ã—ã€ã®ã‚“ã³ã‚Šã—ã¦ã„ã‚‹ã¨é…åˆ»ã—ã¦ã—ã¾ã†ã®ã§ã€å‰ã®ã‚¿ã‚¹ã‚¯ãŒçµ‚ã‚ã‚Šæ¬¡ç¬¬ã€ã§ãã‚‹é™ã‚Šã™ãã«æ¬¡ã«ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ãŸã„ã§ã™ã€‚

ã“ã®ã‚ˆã†ã«æ—¥å¸¸ã¯ã‚¿ã‚¹ã‚¯ãŒè¤‡é›‘ã«ä¾å­˜ã—ã€ãã‚Œãã‚ŒãŒéåŒæœŸã«å‹•ã„ã¦ã„ã¾ã™ã€‚

#### èµ·ããŸã‚‰ã™ãå®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯

- (1) ã‚³ãƒ¼ãƒ’ãƒ¼ã®ãŠæ¹¯ã‚’ã‚ã‹ã™ (ï¼”åˆ†)
- (2) å­ä¾›ã‚’èµ·ã“ã™
  - 3åˆ†ãŠãã®5å›å‘¼ã¶ã¨èµ·ãã‚‹ã€‚ãŸã ã—ã€3åˆ†ä»¥å†…ã®å‘¼ã‚“ã ã‚Šã€5åˆ†ä»¥ä¸Šé–“éš”ãŒé–‹ãã¨ã€æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—
- (3) æœé£Ÿã‚’ã¤ãã‚‹ (15åˆ†)
- (4) ã„ã¤ã‚‚é…ã‚Œã‚‹æ–°èã‚’ã¨ã‚Šã«ã„ã
  - 5åˆ†ä»¥ä¸Šé–“éš”ã‚’ã‚ã‘ã¦ï¼”å›è¦‹ã«è¡Œãã¨ã€æ–°èã¯ãã¦ã„ã‚‹ã€‚ãŸã ã—5åˆ†æœªæº€ã§è¦‹ã«è¡Œãã¨ æœ€åˆã‹ã‚‰ã‚„ã‚ŠãªãŠã—

#### ä¾å­˜ã‚¿ã‚¹ã‚¯

- (5) ãŠæ¹¯ãŒæ¹§ã„ãŸã‚‰ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’ã„ã‚Œã‚‹(1)	(5åˆ†)
- (6) å­ä¾›ãŒèµ·ããŸã‚‰ç€æ›¿ãˆã‚‹(2)	(6åˆ†)
- (7) å­ä¾›ãŒç€æ›¿ãˆãŠã‚ã£ãŸã‚‰æ´—æ¿¯æ©Ÿã‚’ã¾ã‚ã™(6) (13åˆ†)
- (8) æœé£ŸãŒã§ãã‚‹ && ã‚³ãƒ¼ãƒ’ãƒ¼ãŒã§ãã‚‹&& ã“ã©ã‚‚ç€æ›¿ãˆãŠã‚ã‚‹ã®æ¡ä»¶ã‚’æº€ãŸã™ã¨æœé£Ÿã‚’é£Ÿã¹ã‚‹(3)(5)(6) (ï¼™åˆ†)
- (9) æ´—æ¿¯æ©Ÿçµ‚äº†å¾Œã€æ´—æ¿¯ã‚’å¹²ã™(7) (5åˆ†)
- (10) ã‚³ãƒ¼ãƒ’ãƒ¼ãŒã§ãã¦ã„ã¦ã€æ´—æ¿¯ãŒçµ‚ã‚ã£ã¦ã„ãŸã‚‰ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’é£²ã¿çµ‚ãˆã‚‹(5)(9) (ï¼•åˆ†)
- (11) æœé£Ÿçµ‚äº† && ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’é£²ã¿çµ‚ãˆã‚‹ã¨é£Ÿå™¨ã‚’æ´—ã†(10)(8) (ï¼”åˆ†)
- (12) æœé£Ÿçµ‚äº†å¾Œã€å­ä¾›ãŒç”¨æ„ã™ã‚‹(8) (ï¼“åˆ†)
- (13) æ–°èåˆ°ç€ã—ã¦ã„ãŸã‚‰æ–°èãŒèª­ã‚€(4) (8åˆ†)
- (14) 13ã¾ã§ã®ã‚¿ã‚¹ã‚¯ãŒå…¨ã¦çµ‚ã‚ã£ã¦ã„ãŸã‚‰å®¶å‡ºç™º(1~13)

## Promise.allã‚’ä½¿ã†

ã“ã‚Œã‚‰ã®ã‚¿ã‚¹ã‚¯ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ åŒ–ã—ã€éåŒæœŸã§å®Ÿè¡Œã—ã‚ˆã†ã¨è€ƒãˆã¾ã™ã€‚

Twitterã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ã¿ã‚‹ã¨ã€PromiseåŒ–ã—ã¦ã€async/awaitã§å‡¦ç†ã™ã‚‹ã€ã¾ã¨ã‚ãŸã„éƒ¨åˆ†ã¯Promise.allã§å¾…ã¤ã€ã¨ã„ã†æ„è¦‹ãŒå¤šã„ã§ã™ã€‚

https://twitter.com/snakajima/status/1784773464030949547

ã—ã‹ã—ã€ã‚¿ã‚¹ã‚¯(1)(2)(3)(4)ã‚’Promise.allã§å¾…ã¤ã¨ã€(4)ã®ã‚¿ã‚¹ã‚¯ãŒ20åˆ†ä»¥ä¸Šã‹ã‹ã‚Šã¾ã™ãŒã€ãã®é–“ï¼”åˆ†ã§çµ‚ã‚ã£ãŸ(1)ã®ã‚¿ã‚¹ã‚¯ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚

ä»®ã«ã€Promise.allã§å¾…ã£ãŸã¨ã—ã¦ã€æ¬¡ã«å®Ÿè¡Œã§ãã‚‹ã‚¿ã‚¹ã‚¯ã¯ã€(5),(6),(13)ã®ã¿ã§ã™ã€‚

ã“ã®ã‚ˆã†ã«Promise.allã‚’ä½¿ã£ã¦ã€å¯èƒ½ãªã‚¿ã‚¹ã‚¯ã‚’é †æ¬¡å®Ÿè¡Œã—ã¦ã„ãã¨ã€ç¢ºå®Ÿã«é…åˆ»ã—ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

ã‚¿ã‚¹ã‚¯ãŒçµ‚ã‚ã£ãŸã‚‰callbackã•ã›ã€ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚’ã—ã¦æ¬¡ã«å‹•ã‹ã™ã‚‚ã®ã‚’åˆ¤å®šã™ã‚‹ã¨ã§ããã†ã§ã™ãŒã€ç›´æ„Ÿçš„ã«å¤§å¤‰ãã†ãªã®ãŒã‚ã‹ã‚Šã¾ã™ã€‚


#### ChatGPTã«èã„ã¦ã¿ã‚‹

ãƒãƒ£ãƒƒãƒˆGPTã«ç›¸è«‡ã—ã¦ã¿ã¾ã—ãŸãŒã€ãªã‹ãªã‹æœ€é©ãªã‚³ãƒ¼ãƒ‰ã¯ã¤ãã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚
èª²é¡Œã‚’æ•´ç†ã—ã¦ã€æ–°ã—ã„ãƒ¢ãƒ‡ãƒ«ã§è©¦ã›ã°å®Œç’§ãªã‚‚ã®ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã ã‚Œã‹è©¦ã—ã¦ãã ã•ã„ã€‚

https://chatgpt.com/share/88e6f773-eea0-4954-82cf-34192c13cd76?oai-dm=1


### GraphAI

ãã“ã§GraphAIã®ç™»å ´ã§ã™ã€‚
GraphAIã¯ã€å„ã‚¿ã‚¹ã‚¯ã‚’ï¼‘ã¤ï¼‘ã¤ã®ç‹¬ç«‹ã—ãŸTypeScriptã®ã‚³ãƒ¼ãƒ‰ã®Agentã¨ã—ã¦ç”¨æ„ã—ã€ãã®ä¾å­˜é–¢ä¿‚ã‚’yaml/json/dataã§å®šç¾©ã™ã‚Œã°ã€ä¾å­˜é–¢ä¿‚ã‚’è€ƒæ…®ã—ã¦é †æ¬¡ä¸¦åˆ—ã«å®Ÿè¡Œã™ã‚‹TypeScriptã®ã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚

https://github.com/receptron/graphai/


ã‚¿ã‚¹ã‚¯ã¯å˜ç´”ã«sleepé–¢æ•°ã‚’ç”¨æ„ã—ã¦nç§’ã ã‘å¾…ã¤ã‚ˆã†ã«å®Ÿè£…ã—ã¦ã„ã¾ã™ï¼ˆåˆ†ã‚’ç§’ã«èª­ã¿æ›¿ãˆã¦ã„ã‚‹ï¼‰

```TypeScript
const sleep = async (milliseconds: number) => {
  return await new Promise((resolve) => setTimeout(resolve, milliseconds));
};

const task1 = async (time: number) => {
  console.log("start task 1");
  await sleep(time * 1000)
  console.log("end task 1");
};
```

ãã‚Œã‚‰ã®å„ã‚¿ã‚¹ã‚¯ã®ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã—ã¾ã™ã€‚ä»Šå›ã¯TypeScriptã§æ›¸ãã¾ã—ãŸãŒã€yamlã‚„jsonã§æ›¸ãã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ãã®å ´åˆã¯ã€Angetã‚‚åˆ¥ã®æ–¹æ³•ã§æ¸¡ã—ã¾ã™ï¼ˆåˆ¥è¨˜äº‹ã§è§£èª¬äºˆå®šï¼‰

å„ã‚¿ã‚¹ã‚¯ã§å®Ÿè¡Œã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’agentã«æ¸¡ã—ã€ä¾å­˜ãŒã‚ã‚‹ã‚¿ã‚¹ã‚¯ã¯inputsã§ãã®ä¾å­˜ã™ã‚‹ã‚¿ã‚¹ã‚¯ã®åå‰(object/dictonaryã®key)ã‚’æŒ‡å®šã—ã¾ã™ã€‚

```TypeScript
{
  task1: {
    agent: task_1_coffee_water,
  },
  task2: {
    agent: task_2_wakeup,
  },
  task3: {
    agent: task_3_cooking,
  },
  task4: {
    agent: task_4_newspaper,
  },
  task5: {
    agent: task_5_cooking_drip,
    inputs: [":task1"],
  },
  task6: {
    agent: task_6_change,
    inputs: [":task2"],
  },
  task7: {
    agent: task_7_wash,
    inputs: [":task6"],
  },
  task8: {
    agent: task_8_breakfirst,
    inputs: [":task3", ":task5", ":task6"],
  },
  task9: {
    agent: task_9_laundry,
    inputs: [":task7"],
  },
  task10: {
    agent: task_10_coffee,
    inputs: [":task5", ":task9"],
  },
  task11: {
    agent: task_11_wash_dish,
    inputs: [":task8", ":task10"],
  },
  task12: {
    agent: task_12_ready_to_go_out,
    inputs: [":task8",],
  },
  task13: {
    agent: task_13_read_news_paper,
    inputs: [":task4",],
  },
  task14: {
    agent: task_14_go_out,
    inputs: [":task1", ":task2",":task3",":task4",":task5",":task6",":task7",":task8",":task9",":task10",":task11",":task12",":task13",],
  }
```

ã“ã¡ã‚‰ã«å®Œæˆå“ã‚’ãŠã„ã¦ãŠãã¾ã™ãŒã€å„ã‚¿ã‚¹ã‚¯ã‚’é–¢æ•°ã¨ã—ã¦ç”¨æ„ã—ã¾ã™ã€‚
https://github.com/isamu/graphai_doc/blob/main/samples/morning/tasks.ts


ã“ã‚Œã‚’
```
npx ts-node tasks.ts
```
ã§å®Ÿè¡Œã™ã‚‹ã¨ã€éåŒæœŸã«ä¾å­˜ã‚’è€ƒæ…®ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹æ§˜å­ãŒè¦‹ãˆã¾ã™ã€‚

æœã®è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã‚‚ã€äººé–“ãŒå®Ÿè¡Œã—ã¦ã„ã‚‹ã®ã¨åŒæ§˜ã«åŠ¹ç‡ã‚ˆãéåŒæœŸã«å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã¾ã—ãŸã€‚

### ã¾ã¨ã‚

GraphAIã‚’ä½¿ã†ã“ã¨ã§å„ã‚¿ã‚¹ã‚¯ã¯ç‹¬ç«‹ã—ãŸé–¢æ•°ã¨ã—ã¦å®šç¾©ã§ãï¼ˆãªã®ã§ã€ãƒ†ã‚¹ãƒˆã‚‚ç°¡å˜ï¼‰ã€ä¾å­˜ã™ã‚‹ã‚¿ã‚¹ã‚¯ã¯ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ç°¡å˜ã«å®šç¾©ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

ä»Šå›ã®ã‚µãƒ³ãƒ—ãƒ«ã«ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€AgentåŒå£«ã§çµæœã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘æ¸¡ã™ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
