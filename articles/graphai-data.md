---
title: "GraphAI / Agenté–“ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚„ã‚Šã¨ã‚Š(inputs/result/agent)"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [agent, AI, LLM, Tech, GraphAI]
published: true
publication_name: "singularity"
---

:::message
GraphAIè¨˜äº‹ã®ä¸€è¦§ã¯[ã“ã¡ã‚‰](https://zenn.dev/singularity/articles/graphai-index)
:::

## GraphAIã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã¨å…¥å‡ºåŠ›åˆ¶å¾¡ã®åŸºæœ¬

GraphAIã‚’ä½¿ã„ã“ãªã™ä¸Šã§æœ€ã‚‚é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã¯ã€**Agenté–“ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚„ã‚Šã¨ã‚Š**ã§ã™ã€‚  
ç‰¹ã«ã€`inputs`ã®æ§‹é€ ã‚„ãã®å¿œç”¨ã€ãã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ã™ã‚‹ãŸã‚ã®Agentã®ä½¿ã„æ–¹ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒéµã¨ãªã‚Šã¾ã™ã€‚

å…¥åŠ›ã¨å‡ºåŠ›ã®ä»•çµ„ã¿ã‚’é©åˆ‡ã«ç†è§£ã—ã€è‡ªåœ¨ã«æ“ã‚‹ã“ã¨ãŒã§ãã‚Œã°ã€**ã‚ã‚‰ã‚†ã‚‹è¤‡é›‘ãªå‡¦ç†ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ãŒå¯èƒ½**ã§ã™ã€‚

---

### å…¥å‡ºåŠ›ã‚’åˆ¶å¾¡ã™ã‚‹æ–¹æ³•

GraphAIã§ã¯ã€ä»¥ä¸‹ã®3ã¤ã®æ‰‹æ³•ã«ã‚ˆã£ã¦Agentã®å…¥å‡ºåŠ›ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã§ãã¾ã™ï¼š

1. **`inputs`(GOD Format)ã«ã‚ˆã‚‹å…¥åŠ›æŒ‡å®š**  
   - æœ€ã‚‚åŸºæœ¬çš„ãªæ–¹æ³•
   - ã§ãã‚‹é™ã‚Šã“ã®æ–¹æ³•ã§å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢ã—ã€ä»–ã®Agentã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Œã‚‹
   - `Prop function`ã‚„`utility function`ã§ãƒ‡ãƒ¼ã‚¿ã®åŠ å·¥ã‚‚å¯èƒ½

2. **`output` / `passThrough`ã«ã‚ˆã‚‹å‡ºåŠ›æ•´å½¢**
   - Agentã®å‡ºåŠ›å½¢å¼ã‚’èª¿æ•´ã—ãŸã„å ´åˆã«ä½¿ç”¨ã—ã¾ã™
   - å˜ç´”ãªå¤‰æ›ã‚„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§ã‚ã‚Œã°ã€ã“ã¡ã‚‰ã§ååˆ†å¯¾å¿œå¯èƒ½ã§ã™

3. **ãƒ‡ãƒ¼ã‚¿å¤‰æ›ç”¨Agentã®åˆ©ç”¨**
   - ä¸Šè¨˜ã®æ–¹æ³•ã§å¯¾å¿œã§ããªã„å ´åˆã€å°‚ç”¨ã®Agentã‚’ä½¿ã£ã¦ä¸­é–“ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›

---

ã“ã®ã‚ˆã†ã«ã€**å…¥åŠ›â†’å‡¦ç†â†’å‡ºåŠ›**ã®æµã‚Œã‚’æ˜ç¢ºã«è¨­è¨ˆã—ã€å¿…è¦ã«å¿œã˜ã¦å¤‰æ›å‡¦ç†ã‚’æŒŸã‚€ã“ã¨ã§ã€GraphAIä¸Šã§æŸ”è»Ÿã‹ã¤å¼·åŠ›ãªå‡¦ç†ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚


# inputã®åŸºæœ¬

## GOD Format(GraphAI Object Dot Format)ã§å…¥åŠ›(å‰ã®ãƒãƒ¼ãƒ‰ã®å‡ºåŠ›)ã‚’æ•´å½¢ã™ã‚‹
`GOD Format`ã¯ã€GraphAIãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’è¡¨ç¾ã™ã‚‹ãŸã‚ã®è»½é‡ã§äººé–“ãŒèª­ã¿ã‚„ã™ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚GraphAI Object Dot (GOD)ä»•æ§˜ã«åŸºã¥ãã€GraphAIå†…ã§ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã—ãŸã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

`GOD Format`ã¯ã€GraphAIã§ã®ãƒ‡ãƒ¼ã‚¿ä¾å­˜é–¢ä¿‚ã‚’ç°¡æ½”ã«è¨˜è¿°ã§ãã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚æ§‹æ–‡ã¯ã‚³ãƒ­ãƒ³`(:)` ã§å§‹ã¾ã‚Šã€ãƒ‰ãƒƒãƒˆ`(.)`ã§è¦ç´ ã‚’åŒºåˆ‡ã‚Šã¾ã™ã€‚åŸºæœ¬æ§‹é€ ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

```typescript
:nodeId.prop1.prop2.$0.prop3
```


`nodeId`: ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹å…ƒã®ãƒãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
`prop1`, `prop2`: ãƒãƒ¼ãƒ‰å†…ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„ãƒã‚¹ãƒˆã—ãŸãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯é€£çµã™ã‚‹ã“ã¨ã§æ·±ã„éšå±¤ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™ã€‚
é…åˆ—ã®å ´åˆã€è¦ç´ ã¯ `$0`, `$1` ãªã©ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

TypeScriptã§æ›¸ãæ›ãˆã‚‹ã¨ä»¥ä¸‹ã®å‡¦ç†ã¨åŒç­‰ã§ã™ã€‚

```typescript
nodeId["prop1"]["prop2"][0]["prop3]
```

ğŸ”— [GOD Format](https://zenn.dev/singularity/articles/graphai-god-format)
ğŸ”— [GraphAIã®ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã«ã¤ã„ã¦](https://zenn.dev/singularity/articles/graphai-inputs)


## templateè¨˜æ³•

å…¥åŠ›ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«`GOD Format`ã®ãƒ‡ãƒ¼ã‚¿ã‚’åŸ‹ã‚è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

```typescript
"hello, I'm ${:userNode.username}"
```

## æ§‹é€ åŒ–ã•ã‚ŒãŸinputs
`GOD Format`ã‚’templateã¨ã—ã¦ä½¿ã„ã€ã¾ãŸinputsè‡ªä½“ãŒæ§‹é€ åŒ–ã§ãã‚‹ã®ã§ä»¥ä¸‹ã®ã‚ˆã†ãªæŒ‡å®šã§å…¥åŠ›ã‚’å®šç¾©ã§ãã¾ã™ã€‚

```typescript
inputs: {
  messages: [
    {
      role: "system",
      content: "hello, you are a ${:context.person0.system}",
    },
    {
      role: "user",
      content: ":context.person1.greeting",
    },
  ],
  context: ":context",
}
```

### Prop funciton

`GOD Format`ã§ã¯ã€**é–¢æ•°ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æŸ”è»Ÿã«åŠ å·¥**ã™ã‚‹ã“ã¨ãŒã§ãã€ã“ã®æ©Ÿèƒ½ã‚’**Prop Function**ã¨å‘¼ã³ã¾ã™ã€‚  
ãƒ‡ãƒ¼ã‚¿ã®å‹(Arrayã€Objectã€Stringãªã©)ã«å¿œã˜ãŸé–¢æ•°ãŒç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€å…¥åŠ›æ•´å½¢ã‚„å‰å‡¦ç†ã«æ´»ç”¨ã§ãã¾ã™ã€‚

### åŸºæœ¬æ§‹æ–‡

`GOD Format`ã®ãƒ‡ãƒ¼ã‚¿å‚ç…§ã«ã€é–¢æ•°ã‚’ãƒã‚§ãƒ¼ãƒ³ã—ã¦è¨˜è¿°ã—ã¾ã™

```typescript
:node1.array.length()
:node2.object.toJSON()
```

- é–¢æ•°ã¯ **å¿…ãš(\)** ã‚’ä»˜ã‘ã¦å‘¼ã³å‡ºã—ã¾ã™ã€‚
- ä¸€éƒ¨ã®é–¢æ•°ã¯å¼•æ•°ã‚’å—ã‘å–ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
- **ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³**ã«ã‚‚å¯¾å¿œã—ã¦ã„ã¾ã™ï¼š

```typescript
:node1.arrayJSON.jsonParse().length()
:node1.markdownWithJSONSample.codeBlock().jsonParse()
```

### ä¾‹ï¼šä¸»ãªé–¢æ•°ä¸€è¦§

#### Arrayå‘ã‘é–¢æ•°
- `length()`ï¼šé…åˆ—ã®è¦ç´ æ•°ã‚’è¿”ã™
- `flat()`ï¼šãƒã‚¹ãƒˆã•ã‚ŒãŸé…åˆ—ã‚’1æ¬¡å…ƒã«å¤‰æ›
- `toJSON()`ï¼šé…åˆ—ã‚’JSONæ–‡å­—åˆ—ã«å¤‰æ›
- `isEmpty()`ï¼šç©ºé…åˆ—ã‹ã©ã†ã‹ã‚’åˆ¤å®š

#### Stringå‘ã‘é–¢æ•°
- `codeBlock()`ï¼šMarkdownã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯å†…ã®æ–‡å­—åˆ—ã‚’æŠ½å‡º
- `jsonParse()`ï¼šæ–‡å­—åˆ—ã‚’JSONã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã—ã€ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›

ğŸ”— [Prop function](https://zenn.dev/singularity/articles/graphai-prop-function)


### utility function

`Prop funciton`ã¯ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã‚’ã™ã‚‹é–¢æ•°ã§ã™ãŒã€ãã‚Œã«å¯¾ã—ã¦å˜ä½“ã§å‹•ä½œã™ã‚‹é–¢æ•°ã‚‚ã‚ã‚Šã¾ã™ã€‚`utility function`ã¨å‘¼ã³ã¾ã™ã€‚
`GOD Format`ã¨ã—ã¦åˆ©ç”¨ã§ãã¾ã™

- `${@loop}` Loopåˆ©ç”¨æ™‚ã«loop counterã®å€¤ã‚’æ•°å€¤ã§å–å¾—
- `${@now}` ç¾åœ¨æ™‚åˆ»ã®timestamp

ğŸ”— [1.0.8 release note](https://github.com/receptron/graphai/releases/tag/1.0.8)
ğŸ”— [1.0.11 release note](https://github.com/receptron/graphai/releases/tag/1.0.11)

## å…¥å‡ºåŠ›ã®æ¨™æº–åŒ–

Agentã”ã¨ã«ä¼¼ãŸã‚ˆã†ãªå‡¦ç†ã‚’ã—ã¦ã„ã¦ã‚‚ã€å‡ºåŠ›ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ãŒç•°ãªã‚‹ã¨ã€ãã‚Œãã‚Œã®æ§‹é€ ã‚’éƒ½åº¦ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€é–‹ç™ºãƒ»ä¿å®ˆã®ã‚³ã‚¹ãƒˆãŒå¢—åŠ ã—ã¾ã™ã€‚
GraphAIã§ã¯ã€ã“ã†ã—ãŸèª²é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€**æ¨™æº–çš„ãªãƒ‡ãƒ¼ã‚¿ã¯å…±é€šã®å½¢å¼ã§è¿”ã™**ã“ã¨ã‚’æ¨å¥¨ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¤‡æ•°ã®Agentã‚’çµ„ã¿åˆã‚ã›ã‚‹éš›ã®æ•´åˆæ€§ãŒã¨ã‚Œã€ãƒ‡ãƒãƒƒã‚°ã‚„å†åˆ©ç”¨æ€§ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã™ã€‚

### æ¨™æº–åŒ–ã®ãƒ¡ãƒªãƒƒãƒˆ

- Agenté–“ã®ãƒ‡ãƒ¼ã‚¿é€£æºãŒã‚¹ãƒ ãƒ¼ã‚ºã«ãªã‚‹
- ä¸€è²«ã—ãŸå½¢å¼ã«ã‚ˆã‚Šã€å¤‰æ›ã‚„è£œæ­£ã®æ‰‹é–“ãŒæ¸›ã‚‹
- GUIã‚„è‡ªå‹•è£œå®Œã«ã‚ˆã‚‹æ”¯æ´ãŒåŠ¹ãã‚„ã™ããªã‚‹
- ãƒ†ã‚¹ãƒˆã‚„ãƒ­ã‚°å‡ºåŠ›ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…±é€šåŒ–ã§ãã‚‹

GraphAIã§ã¯ã€ã“ã®å…±é€šåŒ–ã•ã‚ŒãŸæ§‹é€ ã‚’ãƒ™ãƒ¼ã‚¹ã«**è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**ã‚’å®šç¾©ã—ã€Agenté–‹ç™ºã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¨ã—ã¦æ´»ç”¨ã—ã¦ã„ã¾ã™ã€‚

ä¾‹ãˆã°ã€Arrayã§ã¯
```typescript
{
  array: [],
  item: "a",
  items: []
}
```
llmã®payloadã¯
```typescript
{
  message: {
    role: "user",
    content: "123"
  }
}
```
ãªã©ãŒã‚ã‚Šã¾ã™ã€‚

è©³ã—ãã¯GitHubã«ã‚ã‚‹ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”è¦§ãã ã•ã„ï¼š  
ğŸ”— [GraphAI Inputs Guide](https://github.com/receptron/graphai/blob/main/docs/guide/inputs.md)

ã”æ„è¦‹ãƒ»ã”è¦æœ›ãŒã‚ã‚Œã°ã€ãœã²ãƒ¬ãƒã‚¸ãƒˆãƒªã«Issueã‚’ç«‹ã¦ã¦è­°è«–ã«ã”å‚åŠ ãã ã•ã„ï¼

Agentã‚’å®Ÿè£…ã™ã‚‹ã¨ãã¯ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«å…¥åŠ›ã€çµæœã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

## çµæœã®å¤‰å½¢

GraphAIã§ã¯ã€Agentã®å‡ºåŠ›çµæœã‚’æŸ”è»Ÿã«èª¿æ•´ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã¨ã—ã¦ã€`output` ã¨ `passThrough` ã®2ã¤ã®è¨­å®šã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

ã“ã‚Œã‚‰ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€AgentãŒè¿”ã™ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’æ„å›³é€šã‚Šã«åˆ¶å¾¡ã§ãã€æ¬¡ã®Nodeã¸ã®é€£æºãŒã‚¹ãƒ ãƒ¼ã‚ºã«ãªã‚Šã¾ã™ã€‚

---

### output

- Agentã®**å‡ºåŠ›çµæœã‚’æ•´å½¢**ã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
- è‡ªèº«ã®Nodeã®å‡ºåŠ›ã®ã¿ã‚’å¯¾è±¡ã¨ã—ã€**ä»–ã®Nodeã‚’å‚ç…§ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“**ã€‚
- `GOD Format`ã«ã‚ˆã‚‹æŒ‡å®šãŒå¯èƒ½ã§ã€å¿…è¦ãªé …ç›®ã ã‘ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¦è¿”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

```typescript
{ extraText: ".text" }
```

ã“ã®ä¾‹ã§ã¯ã€Agentã®å‡ºåŠ›ã® `text` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ `extraText` ã«å¤‰æ›ã—ã€ãã‚Œä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ã¯é™¤å¤–ã•ã‚Œã¾ã™ã€‚

### passThrough

- Agentã®å®Ÿè¡Œçµæœã«**é–¢ä¿‚ãªãã€æŒ‡å®šã—ãŸå€¤ã‚’å‡ºåŠ›ã«è¿½åŠ **ã§ãã¾ã™ã€‚
- ãƒªãƒ†ãƒ©ãƒ«å€¤ã®æŒ‡å®šã‚‚ã€`GOD Format`ã«ã‚ˆã‚‹ä»–ãƒãƒ¼ãƒ‰ã®å‚ç…§ã‚‚å¯èƒ½ã§ã™ã€‚
- ä¸»ã« **å›ºå®šå€¤ã®ä»˜åŠ ** ã‚„ **ä»–ãƒãƒ¼ãƒ‰ã®å‡ºåŠ›ã‚’ãƒãƒ¼ã‚¸** ã™ã‚‹ç”¨é€”ã«ä½¿ã„ã¾ã™ã€‚

```typescript
{ prevResult: ":node1.prop1" }
```

ã“ã®ä¾‹ã§ã¯ã€`:node1.prop1` ã®å€¤ã‚’ç¾åœ¨ã®Nodeã®å‡ºåŠ›ã« `prevResult` ã¨ã—ã¦è¿½åŠ ã—ã¾ã™ã€‚
passThroughã¯ã€æŒ‡å®šã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã™ã‚‹ã®ã§å…ƒã®çµæœã¯ãã®ã¾ã¾å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
é‡è¤‡ã™ã‚‹keyã®å ´åˆã¯ä¸Šæ›¸ãã—ã¾ã™

---

â€» `output` ã¯ Nested Agent ã®å‡ºåŠ›æ•´å½¢ã«ã€`passThrough` ã¯å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚„å›ºå®šå€¤ã®ä»˜åŠ ã«ä½¿ã‚ã‚Œã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚


## ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ã™ã‚‹Agent

`GOD Format` ã‚„ `output` / `passThrough` ã§ã¯å¯¾å¿œã—ãã‚Œãªã„ã‚±ãƒ¼ã‚¹ã§ã¯ã€**ãƒ‡ãƒ¼ã‚¿å¤‰æ›å°‚ç”¨ã®Agent**ã‚’ä½¿ã„ã¾ã™ã€‚

ã“ã‚Œã‚‰ã®Agentã¯é€šå¸¸ã® LLM Agent ã¨åŒæ§˜ã«ã€Nodeã¨ã—ã¦å®šç¾©ã—ã¦ä½¿ã„ã¾ã™ã€‚ä»¥ä¸‹ã«ã€Vanilla Agentã§æä¾›ã•ã‚Œã¦ã„ã‚‹ä¸»ãªãƒ‡ãƒ¼ã‚¿å¤‰æ›ç”¨Agentã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

---

### Arrayé–¢é€£

- `popAgent` / `shiftAgent` / `pushAgent`ï¼šé…åˆ—ã®æ“ä½œã‚’è¡Œã†
- `arrayFlatAgent`ï¼šãƒã‚¹ãƒˆã•ã‚ŒãŸé…åˆ—ã‚’ãƒ•ãƒ©ãƒƒãƒˆã«ã™ã‚‹
- `arrayJoinAgent`ï¼šåŒºåˆ‡ã‚Šæ–‡å­—ã§é…åˆ—ã‚’é€£çµã™ã‚‹
- `arrayToObjectAgent`ï¼šé…åˆ—å†…ã®è¦ç´ ã®æŒ‡å®šãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ã‚­ãƒ¼ã«ã—ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã™ã‚‹
```typescript
  inputs: {
    items: [
      { id: 1, data: "a" },
      { id: 2, data: "b" },
    ],
  },
  params: { key: "id" },
  result: {
    "1": { id: 1, data: "a" },
    "2": { id: 2, data: "b" },
  },
```


### Object/Dictonary/Recordé–¢é€£

#### mergeObjectAgent

è¤‡æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒ¼ã‚¸ã—ã¦1ã¤ã«ã¾ã¨ã‚ã‚‹
inputs
```json
{
  items: [{ color: "red" }, { model: "Model 3" }]
}
```
result
```json
{ color: "red", model: "Model 3" }
```
#### lookupDictionaryAgent

```
params: {
  ja: "ã“ã‚“ã«ã¡ã¯", en: "hello"
}
inputs: { namedKey: "en" },
```
ã®ã¨ãã«ã€"hello"ãŒè¿”ã£ã¦ãã¾ã™ã€‚

paramsã«å®šç¾©ã—ãŸè¾æ›¸ã‹ã‚‰ã€inputsã§æŒ‡å®šã•ã‚ŒãŸã‚­ãƒ¼ã®å€¤ã‚’å–ã‚Šå‡ºã™
JSã§ã®å®Ÿè¡Œã‚¤ãƒ¡ãƒ¼ã‚¸
```typescript
    const data = { ja: "ã“ã‚“ã«ã¡ã¯", en: "hello" };
    return data[index];
```    

#### copyAgent

inputsã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰paramsã§æŒ‡å®šã—ãŸã‚­ãƒ¼ã®å€¤ã‚’æŠ½å‡ºã™ã‚‹
keyã‚’æŒ‡å®šã—ãªã„å ´åˆã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’è¿”ã™(GUIã§ã®Formatå¤‰æ›æ™‚ã«ä¾¿åˆ©)

```
inputs: { color: "red", model: "Model 3" },
params: { namedKey: "color" },
```

`red`ãŒè¿”ã£ã¦ãã¾ã™


JSã§ã®å®Ÿè¡Œã‚¤ãƒ¡ãƒ¼ã‚¸
```typescript
    const namedKey = "name";
    const { namedKey } = namedInputs;
    return user[namedKey];
```

#### property_filter

é«˜åº¦ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æŠ½å‡ºã‚’è¡Œã†(ã‚„ã‚„è¤‡é›‘ãªãŸã‚è©³ç´°ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å‚ç…§)

---

### è¨ˆç®—ç³»

#### totalAgent
å¤šæ¬¡å…ƒé…åˆ—å†…ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’èµ°æŸ»ã—ã€ã‚­ãƒ¼ã”ã¨ã«æ•°å€¤ã‚’åˆè¨ˆã™ã‚‹
```typescript
    {
      inputs: { array: [[{ a: 1, b: -1 }, { c: 10 }], [{ a: 2, b: -1 }], [{ a: 3, b: -2 }, { d: -10 }]] },
      result: { data: { a: 6, b: -4, c: 10, d: -10 } },
    },
```

#### data_sum

æ•°å€¤é…åˆ—ã‚’åˆè¨ˆã—ã¦1ã¤ã®æ•°å€¤ã¨ã—ã¦è¿”ã™
```typescript
    {
      inputs: { array: [1, 2, 3] },
      result: { result: 6 },
    },
```


### Stringé–¢é€£

å¤šãã®å‡¦ç†ã¯ `prop function` ã‚„ `templateè¨˜æ³•` ã«ç½®ãæ›ãˆã‚‰ã‚Œã¤ã¤ã‚ã‚Šã¾ã™ãŒã€ä»¥ä¸‹ã®Agentã‚‚æä¾›ã•ã‚Œã¦ã„ã¾ã™ï¼š

- `json_parser`ï¼šæ–‡å­—åˆ—ã‚’JSONã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹(prop functionã®ä»£æ›¿)
- `string_case_variants`ï¼šæ–‡å­—åˆ—ã‚’ `camelCase`, `snake_case`, `kebab-case` ãªã©ã«å¤‰æ›
- `string_splitter`ï¼šæŒ‡å®šã‚µã‚¤ã‚ºã§æ–‡å­—åˆ—ã‚’åˆ†å‰²(ä¾‹ï¼šRAGã®ãƒãƒ£ãƒ³ã‚¯å‡¦ç†)
- `string_template`ï¼šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨˜æ³•ã«ã‚ˆã‚‹æ–‡å­—åˆ—ç”Ÿæˆ(ç¾åœ¨ã¯templateè¨˜æ³•æ¨å¥¨)
- `string_update_text`ï¼š`oldText` ã¾ãŸã¯ `newText` ã®ã„ãšã‚Œã‹ã‚’è¿”ã™(nullåˆä½“çš„ãªç”¨é€”)
    - return oldText ?? newText;

ã“ã‚Œã‚‰ã®Agentã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚ŠæŸ”è»Ÿã§åˆ¶å¾¡å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†ãŒGraphAIä¸Šã§å®Ÿç¾ã§ãã¾ã™ã€‚

ğŸ”— [Agent document](https://graphai.info/agentDocs/array/arrayFlatAgent.html)



---

## å…¥ã‚Œå­æ§‹é€ ã®Agentï¼ˆnestedAgent / mapAgentï¼‰ã®å…¥åŠ›ã¨å‡ºåŠ›

ã“ã“ã¾ã§ãŒã€ä¸€èˆ¬çš„ãªå…¥åŠ›ãƒ»å‡ºåŠ›ã®æ‰±ã„ã«ã¤ã„ã¦ã®è§£èª¬ã§ã—ãŸã€‚  
ã“ã“ã‹ã‚‰ã¯ã€**GraphAIã‚’å…¥ã‚Œå­ã§å®Ÿè¡Œã™ã‚‹ç‰¹æ®ŠãªAgent**ã§ã‚ã‚‹ `nestedAgent` ã¨ `mapAgent` ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚


### æ¦‚è¦

`nestedAgent` ã‚„ `mapAgent` ã¯ã€å†…éƒ¨ã«ã‚µãƒ–ã‚°ãƒ©ãƒ•ï¼ˆGraphDataï¼‰ã‚’æŒã¡ã€ãã®ä¸­ã§åˆ¥ã®Agentãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€è¤‡é›‘ãªå‡¦ç†ã‚„ä¸¦åˆ—ã§åŒæ™‚ã«åŒã˜å‡¦ç†ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

- **nestedAgent** ã¯ **å˜ç´”ã«ã‚µãƒ–ã‚°ãƒ©ãƒ•ã‚’å…¥ã‚Œå­ã«ã™ã‚‹ã ã‘** ã®æ§‹é€ ã€‚è¦ªã‚°ãƒ©ãƒ•å†…ã§å®šç¾©ã•ã‚ŒãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ã€ç‰¹å®šã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¨ã¨ã‚‚ã«ãã®ã¾ã¾å®Ÿè¡Œã™ã‚‹ã€‚
- **mapAgent** ã¯ **ãƒ‡ãƒ¼ã‚¿ãŒç•°ãªã‚‹ãŒåŒã˜å‡¦ç†ã‚’ä¸¦åˆ—ã«å‹•ã‹ã™ä»•çµ„ã¿**ã€‚é…åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’å±•é–‹ã—ã€ãã‚Œãã‚Œã®è¦ç´ ã«å¯¾ã—ã¦åŒã˜ã‚µãƒ–ã‚°ãƒ©ãƒ•ã‚’å®Ÿè¡Œã™ã‚‹ï¼ˆMapReduce çš„ãªå‡¦ç†ï¼‰ã€‚


### å…¥åŠ›ã®æ‰±ã„

ã“ã‚Œã‚‰ã®Agentã§ã¯ã€`inputs` ã«å®šç¾©ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯ã€**å†…éƒ¨ã®ã‚µãƒ–ã‚°ãƒ©ãƒ•ã«å¯¾ã—ã¦æš—é»™çš„ã«Static Nodeã¨ã—ã¦æ¸¡ã•ã‚Œã¾ã™**ã€‚
ãã®ãŸã‚ã€å†…éƒ¨ã‚°ãƒ©ãƒ•ã§ã¯ `inputs` ã¨ã„ã†åå‰ã®ãƒãƒ¼ãƒ‰ã‚’æ˜ç¤ºçš„ã«è¨­ç½®ã—ãªãã¦ã‚‚ã€è‡ªå‹•çš„ã«å¤–éƒ¨ã® `inputs` ãŒåæ˜ ã•ã‚Œã‚‹ä»•çµ„ã¿ã«ãªã£ã¦ã„ã¾ã™ã€‚

### å‡ºåŠ›ã®æ‰±ã„

å‡ºåŠ›ã¯ã€`isResult: true` ãŒæŒ‡å®šã•ã‚ŒãŸã‚µãƒ–ã‚°ãƒ©ãƒ•ã®Nodeã®çµæœãŒæœ€çµ‚çš„ãªå‡ºåŠ›ã¨ãªã‚Šã€**è¦ªã‚°ãƒ©ãƒ•ã«å¯¾ã—ã¦ãƒã‚¹ãƒˆã•ã‚ŒãŸå½¢ã§è¿”ã•ã‚Œã¾ã™**ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€`nestedAgent` ã‚„ `mapAgent` ã®çµæœã‚‚ä»–ã®é€šå¸¸ã®Nodeã¨åŒæ§˜ã«æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®æ§‹é€ ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€GraphAIã«ãŠã‘ã‚‹**å†åˆ©ç”¨æ€§ã®é«˜ã„ã‚µãƒ–ã‚°ãƒ©ãƒ•è¨­è¨ˆ**ã‚„**å‹•çš„ãªä¸¦åˆ—å‡¦ç†**ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

### nestedGraphã®æš—é»™ã®å…¥åŠ›

- `inputs` ã‚’ **ã‚µãƒ–ã‚°ãƒ©ãƒ•ã® static node ã«ãƒãƒƒãƒ”ãƒ³ã‚°** ã™ã‚‹ã€‚
- ä¾‹ãˆã° `{dataA: 1, dataB: 2}` ã‚’æ¸¡ã™ã¨ã€ãã®ã¾ã¾ã‚µãƒ–ã‚°ãƒ©ãƒ•ã«é©ç”¨ã•ã‚Œã‚‹ã€‚

```yaml
version: 0.5
nodes:
  nested:
    isResult: true
    inputs:
      dataA: 1
      dataB: 2
    agent: nestedAgent
    graph:
      version: 0.5
      nodes:
        copy:
          isResult: true
          agent: copyAgent
          inputs:
            dataA: :dataA
            dataB: :dataB
```

ã“ã®ã‚±ãƒ¼ã‚¹ã§ã¯nestedAgentå®Ÿè¡Œæ™‚ã«ã‚µãƒ–ã‚°ãƒ©ãƒ•ã«

```typescript
dataA: {
 value: 1
}
dataB: {
 value: 2
}
```
ã®static nodeãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚ãã®çµæœ

```json
{
  "nested": {
    "copy": {
      "dataA": 1,
      "dataB": 2
    }
  }
}
```

ã¨ãªã‚Šã¾ã™ã€‚

### nestedAgentã®çµæœ

ã‚µãƒ–ã‚°ãƒ©ãƒ•ã®`isResult: true`ã§æŒ‡å®šã—ãŸçµæœãŒã€ãã®agentã®çµæœã¨ã—ã¦ãã®ã¾ã¾æ¸¡ã•ã‚Œã¾ã™ã€‚

Graph Data
```yaml
version: 0.5
nodes:
  nested:
    isResult: true
    inputs:
      test: [a,b]
      test2: z
    agent: nestedAgent
    graph:
      version: 0.5
      nodes:
        copy:
          isResult: true
          agent: copyAgent
          inputs:
            test: :test
        copy2:
          isResult: true
          agent: copyAgent
          inputs:
            test2: :test2
        copy3:
          agent: copyAgent
          inputs:
            test2: :test2
```

çµæœ
```json
{
  "nested": {
    "copy": [
      "a",
      "b"
    ],
    "copy2": "z"
  }
}
```


### MapAgenthã®æš—é»™ã®å…¥åŠ›

- `rows` ã« **å¿…ãšé…åˆ—ã‚’æŒ‡å®š** ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
- é…åˆ—ã®å„è¦ç´ ãŒ `row` ã¨ã—ã¦ã‚µãƒ–ã‚°ãƒ©ãƒ•ã«æ¸¡ã•ã‚Œã€**é…åˆ—ã®é•·ã•ã ã‘ã‚µãƒ–ã‚°ãƒ©ãƒ•ãŒç”Ÿæˆ** ã•ã‚Œã‚‹ï¼ˆMapReduce çš„ãªå‡¦ç†ï¼‰ã€‚
- `rows` ä»¥å¤–ã® `inputs` ã¯ã€ãã®ã¾ã¾ã‚µãƒ–ã‚°ãƒ©ãƒ•ã«æ¸¡ã•ã‚Œã‚‹ã€‚
- `rows` ä»¥å¤–ã® `inputs` ã« **é…åˆ—ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãã®ã¾ã¾ã‚³ãƒ”ãƒ¼ã•ã‚Œã€ã™ã¹ã¦ã®ã‚µãƒ–ã‚°ãƒ©ãƒ•ã«æ¸¡ã‚‹**ã€‚ãªã®ã§ã€rowsã ã‘ãŒé…åˆ—ã‚’ç‰¹æ®Šã«æ‰±ã„ã¾ã™ã€‚


```yaml
version: 0.5
nodes:
  map:
    isResult: true
    inputs:
      rows: [1,2]
      test: [a,b]
      test2: z
    agent: mapAgent
    graph:
      version: 0.5
      nodes:
        copy:
          isResult: true
          agent: copyAgent
          inputs:
            data: :row
            test: :test
            test2: :test2
```

ï¼’ã¤ã®å‡¦ç†ãŒä¸¦åˆ—ã§å®Ÿè¡Œã•ã‚Œã€ãã‚Œãã‚Œã®GraphDataã«ã¯ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ãŒStatic Nodeã¨ã—ã¦injectã•ã‚Œã¾ã™ã€‚
```typescript
{
  data: 1
  test: [a,b]
  test2: z
}
```

```typescript
{
  data: 2
  test: [a,b]
  test2: z
}
```


### MapAgentã®çµæœ
- ã‚µãƒ–ã‚°ãƒ©ãƒ•ã®çµæœã¯ **é…åˆ—ã¨ã—ã¦è¿”ã•ã‚Œã‚‹**ã€‚
- ãã®ãŸã‚ã€ã‚µãƒ–ã‚°ãƒ©ãƒ•å†…ã®ç‰¹å®šã®ãƒãƒ¼ãƒ‰ã®çµæœã ã‘ã‚’å–å¾—ã™ã‚‹ã®ã¯å°‘ã—ä¸ä¾¿ã€‚

```json
{
  "map": [
    {
      "copy": {
        "data": 1,
        "test": [
          "a",
          "b"
        ],
        "test2": "z"
      }
    },
    {
      "copy": {
        "data": 2,
        "test": [
          "a",
          "b"
        ],
        "test2": "z"
      }
    }
  ]
}
```


#### `compositeResult: true` ã®åˆ©ç”¨
- **ãƒãƒ¼ãƒ‰ã”ã¨ã®çµæœã‚’é…åˆ—ã«ã¾ã¨ã‚ã¦ãã‚Œã‚‹**ã€‚
- ã“ã‚Œã«ã‚ˆã‚Šã€æ¬¡ã® Agent ãŒ **ç‰¹å®šã®ãƒãƒ¼ãƒ‰ã®çµæœã ã‘** ã‚’å–å¾—ã—ã‚„ã™ããªã‚‹ã€‚

```yaml
    params:
      compositeResult: true
```

```json
{
  "map": {
    "copy": [
      {
        "data": 1,
        "test": [
          "a",
          "b"
        ],
        "test2": "z"
      },
      {
        "data": 2,
        "test": [
          "a",
          "b"
        ],
        "test2": "z"
      }
    ],
    "copy2": [
      {
        "data": 1,
        "test": [
          "a",
          "b"
        ],
        "test2": "z"
      },
      {
        "data": 2,
        "test": [
          "a",
          "b"
        ],
        "test2": "z"
      }
    ]
  }
}
```

# Appendix

### defaultValue

å°‘ã—ç‰¹æ®Šãªä¾‹ã§defaultValueã¨ã„ã†æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã‚Œã¯ã€if/unlessã§nodeã‚’åˆ¶å¾¡ã™ã‚‹ã¨ãã«ã€æ¡ä»¶ã«ãƒãƒƒãƒã—ãªã‹ã£ãŸå ´åˆã®è¿”ã™å€¤ã‚’æŒ‡å®šã—ã¾ã™ã€‚
ã“ã‚Œã‚’ä½¿ã‚ãªã„ã¨ã€if/unlessã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ã™ã‚‹ã¨ãã«ã€if/unlessã®ãã‚Œãã‚Œã®nodeã‚’ä½œæˆã—ã€ãã‚Œã‚‰ã®nodeã‹ã‚‰ã®å…¥åŠ›ã¨anyInputã‚’æŒ‡å®šã—ãŸnodeãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚defaultValueã‚’ä½¿ã†ã¨ãã®ã‚ˆã†ãªè¤‡é›‘ãªæ§‹æˆã¯ä¸è¦ã¨ãªã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®ä¾‹ã§ã¯message nodeã®resultãŒtrueã®å ´åˆã€textã«ã¯":message.text"ãŒã‚»ãƒƒãƒˆã•ã‚Œã€falseã®å ´åˆã«ã¯ "this is default"ãŒã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚
ä»Šã¾ã§ã§ã‚ã‚Œã°ã€`unless: ":message.result"`ã®nodeã¨ã€ãã‚‰ã‚’å—ã‘å–ã‚‹`anyInput: true`ãŒã‚»ãƒƒãƒˆã•ã‚ŒãŸnodeãŒå¿…è¦ã§ã—ãŸã€‚
```typescript
      copy: {
        agent: "copyAgent",
        inputs: {
          text: ":message.text",
        },
        if: ":message.result",
        defaultValue: {
          text: "this is default",
        },
      }
```


ğŸ”— [anyInput](https://zenn.dev/singularity/articles/graphai-anyinput)


### GUIãƒ„ãƒ¼ãƒ«å‘ã‘ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯
  - GUIã¯å…¥åŠ›ã‚’è¡¨ç¾ã™ã‚‹ã®ãŒé›£ã—ã„
    - ç‰¹ã«Array
    - ï¼‘ã¤ã®å…¥åŠ›ã®ï¼’ã¤ä»¥ä¸Šã®Edgeã‚’è¨±å¯ã™ã‚‹ã¨ã€é€”ç«¯ã®é›£ã—ããªã‚‹
      - array -> array
      - item, item -> array
      - array, item -> array (NG)
      - UIä¸Šã®åˆ¶é™ã‚„ã€åˆ¤å®šã‚’ãŒå¿…è¦ã«ãªã‚‹
    - array -> arrayã¨item -> itemã ã‘ã«åˆ¶ç´„
  - ã“ã®ã‚ˆã†ãªå•é¡Œã‚’å›é¿ã™ã‚‹ãŸã‚ã«Grapysã§ã¯ã€ï¼‘ã¤ã®å…¥åŠ›ã«ã¯ï¼‘ã¤ã®Edgeã—ã‹æ¥ç¶šã§ããªã„ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã€‚
  - ãã®ãŸã‚è¤‡é›‘ãªå…¥åŠ›ã¯ã€ç›´æ¥GUIä¸Šã§ã¯è¦ã—ãªã„ã€‚
  - inputsã®objectã®æ•´å½¢ã‚‚GUIã‹ã‚‰agentã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™æ®µéšã§ã€å†…éƒ¨ã«å¤‰æ›ã‚³ãƒ¼ãƒ‰ã‚’æŒãŸã›ã¦ã„ã‚‹
  - item, item -> array ã®å¤‰æ›ã¯å¤‰æ›ç”¨ã®Agentã€‚å…¥åŠ›ã®æ•°ã¯å¸¸è­˜çš„ãªæœ‰é™å€‹
    - ã“ã®å¤‰æ›ã«copyAgentãŒä½¿ãˆã‚‹
  - è©³ã—ãã¯Grapysã®ã‚³ãƒ¼ãƒ‰ã‚’å‚ç…§

https://github.com/receptron/grapys/blob/main/packages/grapys-vue/src/utils/gui/data.ts
https://github.com/receptron/grapys/blob/main/packages/grapys-vue/src/utils/gui/utils.ts

- ã“ã‚Œã‚‰ã®GUIãƒ„ãƒ¼ãƒ«ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’æ´»ç”¨ã™ã‚‹ã¨ã€é€šå¸¸ã®GraphDataã§ã‚‚æ±ç”¨çš„ãªä½œã‚ŠãŒã§ãã‚‹





