---
title: "GraphAIã®ç´¹ä»‹"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [agent, AI, LLM, Tech, GraphAI]
published: true
publication_name: "singularity"
---

# GraphAIã¨ã¯

GraphAIã¯ã€LLM/RAG/Tools/DBãªã©ã®è¤‡æ•°ã®Agentã‚’çµ„ã¿åˆã‚ã›ã¦ä½œã‚‹ã€Multi agentsã‚·ã‚¹ãƒ†ãƒ ã‚’åŠ¹ç‡ã‚ˆãæ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚

Multi agentsã‚‚æ•°å€‹ã®å˜ç´”ãªçµ„ã¿åˆã‚ã›ã§ã‚ã‚Œã°ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§è¨˜è¿°ã™ã‚‹ã“ã¨ã¯å®¹æ˜“ã§ã™ã€‚ã—ã‹ã—ã€è¤‡é›‘ãªçµ„ã¿åˆã‚ã›ã¦ã€ä¸¦åˆ—å®Ÿè¡Œã‚„ãƒ‡ãƒ¼ã‚¿ã®ä¾å­˜é–¢ä¿‚ãŒã‚ã‚‹å ´åˆã€ä¸¦åˆ—ã§å‹•ãMulti agentsã‚’ä½œã‚‹ã“ã¨ã¯å®¹æ˜“ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
æœ€é©åŒ–ã‚’è€ƒãˆãªã„ã§ä½œã‚Œã°ä½œã‚‹ã“ã¨ã¯ã§ãã¾ã™ãŒã€ãã‚Œãã‚Œã®å‡¦ç†ã«æ•°ç§’ã‹ã‹ã‚‹Agentã‚’å¤šãçµ„ã¿åˆã‚ã›ã‚‹ã¨ãƒ¦ãƒ¼ã‚¶ã¸ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãŒæ¥µç«¯ã«é…ããªã‚Šã¾ã™ã€‚ã¾ãŸã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã‚„ã€ã‚µãƒ¼ãƒã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã®å½¹å‰²ã€Streamå‡¦ç†ãªã©ã€ç¾åœ¨ã®AIã‚·ã‚¹ãƒ†ãƒ ã¯æ§˜ã€…ãªè¦æ±‚ãŒã‚ã‚Šã¾ã™ã€‚

GraphAIã¯

- è¤‡é›‘ãªéåŒæœŸ/ä¸¦åˆ—å‡¦ç†ã¨ãƒ‡ãƒ¼ã‚¿ã®ä¾å­˜é–¢ä¿‚ã‚’è§£æ±ºã§ãã‚‹
- TypeScriptã§æ›¸ã‹ã‚Œã¦ã„ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¨ã‚µãƒ¼ãƒã®ä¸¡æ–¹ã§å‹•ãã¾ã™ã€‚
- Agentã¯ï¼‘ã¤ã®ã‚³ãƒ¼ãƒ‰ã§ã‚µãƒ¼ãƒã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ä¸¡æ–¹ã§å‹•ã‹ã™ã“ã¨ãŒã§ãã‚‹
- ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰åˆ©ç”¨ã™ã‚‹å ´åˆã€å°‘ã—ã®è¨­å®šã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ãƒ–ãƒ©ã‚¦ã‚¶ã®Agentã‚’å‘¼ã³å‡ºã™ã ã‘ã§ã‚µãƒ¼ãƒã§Agentã‚’å®Ÿè¡Œã§ãã‚‹
- Streamã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã€ã‚µãƒ¼ãƒã§ã‚µãƒãƒ¼ãƒˆã™ã‚‹
- GraphAIã‚’ä½¿ã†ãŸã‚ã«æ§˜ã€…ãªãƒ„ãƒ¼ãƒ«ã‚„ã‚µãƒ³ãƒ—ãƒ«ãŒæƒã£ã¦ã„ã‚‹

ã¨ã„ã£ãŸç‰¹å¾´ãŒã‚ã‚Šã¾ã™ã€‚

GraphAIã§ä½¿ã†Agentã¯

- Agentã¯ã€ãã‚Œå˜ä½“ã§å®Ÿè£…/ãƒ†ã‚¹ãƒˆãŒã§ãã‚‹ã®ã§ã€é–‹ç™ºã—ã‚„ã™ã„
- Open Sourceã§æä¾›ã•ã‚Œã¦ã„ã‚‹Agentã‚’åˆ©ç”¨ã§ãã‚‹

ã§ã™ã€‚

ç¾åœ¨ã¯ã€receptronã¨ã„ã†çµ„ç¹”ã§é–‹ç™ºã‚’ã—ã¦ã„ã¾ã™ã€‚

## Quick Start

ã¾ãšã¯ã€ç°¡å˜ã«GraphAIã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚npmã®ç’°å¢ƒã¨OpenAIã®api keyã‚’ç”¨æ„ã—ã¦ãã ã•ã„ã€‚

ãã—ã¦ã€GraphAI ã® cliã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```sh
npm i -g  @receptron/graphai_cli
```

ä»¥ä¸‹ã®yamlãƒ•ã‚¡ã‚¤ãƒ«(Graphãƒ‡ãƒ¼ã‚¿)ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„ã€‚

https://raw.githubusercontent.com/receptron/graphai/main/packages/cli/samples/business_idea_jp.yaml

ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã«.envã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¤ãã£ã¦OpenAIã®API KEYã‚’è¨˜è¿°ã—ã¾ã™ã€‚

```
OPENAI_API_KEY=sk-xxxx
```

ç”¨æ„ã¯ä»¥ä¸Šã§ã™ã€‚å®Ÿè¡Œã—ã¾ã™ã€‚

```sh
graphai business_idea_jp.yaml
```

æˆåŠŸã—ã¦ã„ã‚Œã°ã€ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ã§ã—ã°ã‚‰ãã¾ã¡ã¾ã™ã€‚

ã—ã°ã‚‰ãã™ã‚‹ã¨ã€ã€Œã“ã®ãƒ“ã‚¸ãƒã‚¹ã‚¢ã‚¤ãƒ‡ã‚¢ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã€ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã€è©•ä¾¡ã€çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

yamlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¿ã‚‹ã¨æµã‚Œã¯ã‚ã‹ã‚‹ã¨æ€ã„ã¾ã™ãŒOpenAIã®GPTã«å•ã„åˆã‚ã›ã‚‹AgentãŒï¼“å›å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚
GPT(AI)ã¸ã®å•ã„åˆã‚ã›ã¨ã€ãã®çµæœã‚’ä½¿ã£ã¦æ›´ã«å•ã„åˆã‚ã›ã‚’ã™ã‚‹ã¨ã„ã†æµã‚Œã§ã™ã€‚

å•ã„åˆã‚ã›ã®å†…å®¹ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€ãƒ“ã‚¸ãƒã‚¹ã‚¢ã‚¤ãƒ‡ã‚¢ä»¥å¤–ã®çµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã€æ”¹è‰¯ã—ã¦ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ã€‚

ã“ã®ã‚ˆã†ã«ã€yamlãƒ•ã‚¡ã‚¤ãƒ«ã«å®šç¾©ã™ã‚‹ã“ã¨ã§ã€ç°¡å˜ã«AIã‚’ä½¿ã£ãŸAgentã‚’çµ„ã¿åˆã‚ã›ã¦å‹•ã‹ã™ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚


## Sample

### yamlã®ã‚µãƒ³ãƒ—ãƒ«

graphaiã®cliã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã§ãã‚‹yamlã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚`@receptron/graphai_cli`ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã§ã‚ã‚Œã°

```sh
graphai {filename}
```

ã§å®Ÿè¡Œã§ãã¾ã™ã€‚

- https://github.com/receptron/graphai/tree/main/packages/cli/samples



### tsã®ã‚µãƒ³ãƒ—ãƒ«

typescriptã§æ›¸ã‹ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚ã‚½ãƒ¼ã‚¹ã‚’cloneã—ã¦ã€ãã‚Œãã‚Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã§ãã¾ã™ã€‚

```sh
yarn run samples {sampleFile}
```

- https://github.com/receptron/graphai/tree/main/packages/samples/src
- https://github.com/receptron/graphai/tree/main/agents/llm_agents/samples

## ç°¡å˜ãªGraphAIã®ä½¿ã„æ–¹

ã“ã¡ã‚‰ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚è‹±èªã§ã™ãŒã€ã»ã¨ã‚“ã©ãŒã‚½ãƒ¼ã‚¹ãªã®ã§ç¿»è¨³ã‚’ä½¿ã„ãªãŒã‚‰ã§ã‚‚ç°¡å˜ã«ç†è§£ã§ãã¾ã™ã€‚

[å…¬å¼ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«](https://github.com/receptron/graphai/blob/main/docs/Tutorial.md)

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ã€graphai_cliã‚’ä½¿ã£ã¦Cliã§yamlã‚’èª­ã¿è¾¼ã‚“ã§GraphAIã‚’ä½¿ã„ã¾ã™ã€‚
graphai_cliã¯GraphAIæœ¬ä½“ã¨ã€@graphai/agentsã‚’å«ã‚“ã§ã„ã¦ã€å…¨ã¦ã®Agentã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚



<!--  ## inputã«ã¤ã„ã¦  ## nestã—ãŸGraphã«ã¤ã„ã¦   ## loopã«ã¤ã„ã¦ ## any/ifã®ä½¿ã„æ–¹ -->

## GraphAIã®ç°¡å˜ãªå‹•ä½œã®æµã‚Œ

- yamlã‚„json,TypeScriptã§è¨˜è¿°ã•ã‚ŒãŸGraphãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
- Graphãƒ‡ãƒ¼ã‚¿ã«çŸ›ç›¾ãŒãªã„ã‹validationã‚’ã™ã‚‹ã€‚çŸ›ç›¾ãŒã‚ã‚Œã°ã‚¨ãƒ©ãƒ¼ã§çµ‚äº†
- å…¨ã¦ã®Computed nodeã‚’ã‚¿ã‚¹ã‚¯ã‚­ãƒ¥ãƒ¼ã«å…¥ã‚Œã¦ã€ä¾å­˜ãŒãªã„Nodeã‹ã‚‰å®Ÿè¡Œã™ã‚‹
- ï¼‘ã¤ã®Nodeã®å®Ÿè¡ŒãŒçµ‚ã‚ã‚‹ã¨ã€ãã‚Œã«ä¾å­˜ã—ã€ä»–ã®ã‚¿ã‚¹ã‚¯å¾…ã¡ãŒãªã„Nodeã‚’æ¢ã—ã€è¦‹ã¤ã‹ã‚Œã°ãã®NodeãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãŸã ã—ä¸¦åˆ—å‹•ä½œã®ä¸Šé™ã«é”ã—ãŸå ´åˆã«ã¯å®Ÿè¡Œå¾…ã¡ã¨ãªã‚‹ã€‚
- AgentFilterãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€å„Nodeã®å®Ÿè¡Œå‰ã«AgentFilterãŒå®Ÿè¡Œã•ã‚Œã‚‹
- å…¨ã¦ã®Nodeã®å®Ÿè¡ŒãŒçµ‚ã‚ã‚‹ã¨isResultã§æŒ‡å®šã•ã‚ŒãŸNodeã®çµæœãŒè¿”ã•ã‚Œã‚‹ã€‚LoopæŒ‡å®šãŒã‚ã‚‹å ´åˆã¯ã€æœ€åˆã‹ã‚‰å®Ÿè¡Œã•ã‚Œã‚‹ã€‚

## GraphAIã®Node.jsã§ä½¿ã„æ–¹

GraphAIã‚’å‹•ä½œã•ã›ã‚‹ã®ã«å¿…è¦ãªæœ€å°é™ã®npmã¯graphaiã¨ã„ãšã‚Œã‹ã®agentã§ã™ã€‚
æœ€ã‚‚ç°¡å˜ã«ä½¿ãˆã‚‹Agentã®vanilla agents(@graphai/vanilla ä»–ã«ä¾å­˜ãŒãªã„agentã‚’vanillaã¨å‘¼ã‚“ã§ã„ã¾ã™)ã‚’ä½¿ã£ã¦ç°¡å˜ãªGraphãƒ‡ãƒ¼ã‚¿ã‚’ä½œã‚Šã€å‹•ã‹ã—ã¦ã¿ã¾ã™ã€‚

æœ€åˆã«npmã®åˆæœŸåŒ–ã‚’ã—ã¦ã€å¿…è¦ãªnpmã‚’å…¥ã‚Œã¾ã™ã€‚typescriptã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ts-nodeã‚‚å…¥ã‚Œã¾ã™ã€‚

```sh
npm init
yarn add graphai @graphai/vanilla ts-node
```

ä»¥ä¸‹ãŒæœ€å°é™ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚graphai.tsã§ä¿å­˜ã—ã¾ã™ã€‚
Static nodeã®node1ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŒ‡å®šã—ã¦ã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã£ãŸComputed nodeã®node2ã§bypassAgentã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
node2ã®çµæœã‚’å‡ºåŠ›ã¨ã—ã¦ã‹ãˆã—ã¾ã™ã€‚

```typescript
import { GraphAI } from "graphai";
import * as agents from "@graphai/vanilla";

const graph_data = {
  version: 0.5,
  nodes: {
    node1: {
      value: "hello, GraphAI",
    },
    node2: {
      agent: "bypassAgent",
      inputs: [":node1"],
      isResult: true,
    },
  },
};

export const main = async () => {
  const graph = new GraphAI(graph_data, agents);
  const result = await graph.run();
  console.log(JSON.stringify(result));

};

if (process.argv[1] === __filename) {
  main();
}
```

å®Ÿè¡Œã—ã¾ã™
```shell-session
$ npx ts-node graphai.ts
{"node2":["hello, GraphAI"]}
```

node1ã§æŒ‡å®šã—ã¦æ–‡å­—åˆ—ãŒnode2ã«æ¸¡ã•ã‚Œã€çµæœã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚


## Webã®ã‚µãƒ³ãƒ—ãƒ«

Vue3ã§æ›¸ã‹ã‚ŒãŸwebã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚

https://github.com/receptron/graphai-demo-web

ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ãƒˆ
https://graphai-demo.web.app/


![](/images/graphai/web-demo.png)

## Webã®ã‚µãƒ³ãƒ—ãƒ«Streamç·¨

LLMã‚’ã‚µãƒ¼ãƒã§å‹•ã‹ã—ã€ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’streamã§å—ã‘å–ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚
ã‚µãƒ¼ãƒå´ã€ã‚¯ãƒ©ã‚¢ãƒ³ãƒˆå´ã€ä¸¡æ–¹ã§streamã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚


https://github.com/isamu/graphai-stream-web

localã§å‹•ä½œã—ã¾ã™ã€‚

root directoryã¨server directoryã§npmã®install.

```sh
yarn install
```

vueã®èµ·å‹•

```sh
yarn run serve
```

serverã®èµ·å‹•

```sh
yarn run server
```

ã§åˆ©ç”¨ã§ãã¾ã™ã€‚

![](/images/graphai/stream.gif)



## ãƒ¬ãƒã‚¸ãƒˆãƒªã¨npmæ§‹æˆ

### ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

https://github.com/receptron/graphai

ã«ã‚ã‚Šã¾ã™ã€‚ã“ã®ãƒ¬ãƒã‚¸ãƒˆãƒªã¯ãƒ¢ãƒãƒ¬ãƒã¨ãªã£ã¦ã„ã¦ã€GraphAIæœ¬ä½“ã®ä»–ã«ã€å„ç¨®ãƒ„ãƒ¼ãƒ«ã‚„AgentãŒå«ã¾ã‚Œã¾ã™ã€‚

- [packagesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª](https://github.com/receptron/graphai/tree/main/packages)
  - GraphAIæœ¬ä½“ã¨cliã‚„ãƒ†ã‚¹ãƒˆç”¨ã®å„ç¨®ãƒ„ãƒ¼ãƒ«ã€AgentFilter,å…¨ã¦ã®Agentã‚’åˆ©ç”¨ã§ãã‚‹agentã®ãƒ¡ã‚¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã©
- [agentsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª](https://github.com/receptron/graphai/tree/main/agents)
  - GraphAIã§åˆ©ç”¨ã™ã‚‹agentsãŒãã‚Œãã‚Œã®åˆ†é¡ã”ã¨ã«åˆ†ã‹ã‚Œã¦ãŠã„ã¦ã‚ã‚‹

å„packages/agentsä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ãã‚Œãã‚Œã®npmã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

GraphAIæœ¬ä½“ã¯ https://github.com/receptron/graphai/blob/main/packages/graphai/src/ ä»¥ä¸‹ã®

- [graphai.ts](https://github.com/receptron/graphai/blob/main/packages/graphai/src/graphai.ts)
  - GraphAIæœ¬ä½“
- [node.ts](https://github.com/receptron/graphai/blob/main/packages/graphai/src/node.ts)
  - Agentã¨å¯¾å¿œã™ã‚‹Node
- [task_manager.ts](https://github.com/receptron/graphai/blob/main/packages/graphai/src/task_manager.ts)
  - ä¸¦åˆ—å‡¦ç†ã‚’å«ã‚€Agentã®å®Ÿè¡Œã‚’ç®¡ç†ã™ã‚‹ã‚¿ã‚¹ã‚¯ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
- [type.ts](https://github.com/receptron/graphai/blob/main/packages/graphai/src/type.ts)
  - å‹å®šç¾©

ã®ï¼”ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€åˆã‚ã›ã¦ã‚‚1000è¡Œç¨‹åº¦ã¨ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«ä½œã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

æœ¬ä½“ä»¥å¤–ã«Agent/AgentFilter/Validator/GraphAIã®æ©Ÿèƒ½ã‚’æ‹¡å¼µã™ã‚‹Agent(nestã—ãŸGraphã‚„Graphã‚’ä¸¦åˆ—ã§å‹•ã‹ã™ï¼‰ãªã©ã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ãŸã‚ã€ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¨ãƒ³ã‚¸ãƒ³ã§è¤‡é›‘ãªå‡¦ç†ã‚’è¡Œã†ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚



## npm package

npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ä»¥ä¸‹ã§é…å¸ƒã—ã¦ã„ã¾ã™ã€‚

#### GraphAIæœ¬ä½“

https://www.npmjs.com/package/graphai

#### GraphAIé–¢é€£ãƒ„ãƒ¼ãƒ«

receptronã®organizationé…ä¸‹ã§ã€ãƒ„ãƒ¼ãƒ«ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

yamlã‚„jsonã‚’cliã§èª­ã¿è¾¼ã‚“ã§ä½¿ã†ãƒ„ãƒ¼ãƒ«ã‚„expressã®middlewareãªã©ãŒã‚ã‚Šã¾ã™ã€‚

[receptron organization](https://www.npmjs.com/org/receptron)

#### Agents

[graphai organization](https://www.npmjs.com/org/graphai)ä¸‹ã§ã€Agentã‚’é…å¸ƒã—ã¦ã„ã¾ã™ã€‚
 
- [@graphai/agents](https://www.npmjs.com/package/@graphai/agents)
  - é…å¸ƒã—ã¦ã„ã‚‹å…¨ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç››ã‚Šè¾¼ã‚“ã ãƒ¡ã‚¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€‚
  - å«ã¾ã‚Œã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€[ã“ã“ã®ã‚½ãƒ¼ã‚¹](https://github.com/receptron/graphai/blob/main/packages/agents/src/index.ts)ã‚’å‚ç…§ã—ã¦ãã ã•ã„
- [@graphai/vanilla](https://www.npmjs.com/package/@graphai/vanilla)
  - ä»–ã®npmã«ä¾å­˜ã—ãªã„agentç¾¤
    - nestedGraph
    - arrayã®å‡¦ç†
    - ãƒ‡ãƒ¼ã‚¿å‡¦ç†
    - æ–‡å­—åˆ—ã‚„jsonã®å¤‰æ›
- [@graphai/service_agents](https://www.npmjs.com/package/@graphai/service_agents)  
  - wikipediaã‚„fetchãªã©ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã†agent.
- [@graphai/llm_agents](https://www.npmjs.com/package/@graphai/llm_agents)
  - LLMã®agent. LLMã‚’apiçµŒç”±ã§ä½¿ã†ã®ã«API KEYãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚ã‚µãƒ¼ãƒã§ä½¿ã†ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚
- [@graphai/data_agents](https://www.npmjs.com/package/@graphai/data_agents)
  - ãƒ‡ãƒ¼ã‚¿åŠ å·¥ç”¨ã®Agent. vanillaã«å…¥ã‚Œãªã‹ã£ãŸä¾å­˜é–¢ä¿‚ã®ã‚ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

## ç”¨èªèª¬æ˜

- Graph
  - å††ã‚°ãƒ©ãƒ•ã‚„æ£’ã‚°ãƒ©ãƒ•ã®ã‚°ãƒ©ãƒ•ã§ã¯ãªãã€ã‚°ãƒ©ãƒ•ç†è«–ã®ã‚°ãƒ©ãƒ•ã€‚Nodeã¨ãã‚Œã‚’ã¤ãªãEdgeã§ã€ãã‚Œãã‚Œã®Nodeã®é–¢é€£æ€§ã‚’ç¤ºã™
- GraphAI
  - GraphAIæœ¬ä½“
- Graphãƒ‡ãƒ¼ã‚¿
  - GraphAIã§ä½¿ã†Graphã‚’å®šç¾©ã—ãŸãƒ‡ãƒ¼ã‚¿ã€‚ã‚°ãƒ©ãƒ•ç†è«–ã®Nodeã¯nodeã¨ã—ã¦ã€edgeã¯inputsã§å®šç¾©ã•ã‚Œã‚‹ã€‚ã‚°ãƒ©ãƒ•ã¯æœ‰å‘ã‚°ãƒ©ãƒ•ã§é–‰loopãªã—ã€‚
  - yaml, jsonãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã—ãŸã‚Šã€TypeScriptã§ç›´æ¥è¨˜è¿°ã‚‚å¯èƒ½ã€‚
- Agent
  - GraphAIã§å®Ÿè¡Œã•ã‚Œã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚å„Node(Computed Node)ã¯ï¼‘ã¤ã®Agentã¨å¯¾å¿œã—ã€å®Ÿè¡Œã™ã‚‹ã€‚åŒã˜Agentã‚’è¤‡æ•°ã®Nodeã§ä½¿ã†ã“ã¨ã‚‚ã§ãã‚‹ã€‚LLMã‚’å®Ÿè¡Œã™ã‚‹LLM Agentã‚„ã€ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹popAgent, stringAgentãªã©ãŒã‚ã‚‹ã€‚TypeScriptã§è¨˜è¿°ã™ã‚‹
- Node
  - Graphã®Nodeã€‚Static Nodeã¨Computed Nodeã®ï¼’ç¨®é¡ãŒã‚ã‚‹ã€‚
- Static Node
  - ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’æ‰±ã†Nodeã€‚åˆæœŸå€¤ã‚’å®šç¾©ã—ãŸã‚Šã€loop(åŒã˜ã‚°ãƒ©ãƒ•ã‚’ç¹°ã‚Šè¿”ã—å‡¦ç†ã™ã‚‹ï¼‰æ™‚ã«ã€å‰å›å®Ÿè¡Œã—ãŸçµæœã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å—ã‘å–ã‚‹ã€‚
- Computed Node
  - Agentã«å¯¾å¿œã—ãŸNodeã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹
- Agent Filter
  - å„Agentã‚’å®Ÿè¡Œã™ã‚‹å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚å…±é€šã®å‡¦ç†ã€Agentã®ãƒ‡ãƒ¼ã‚¿ã®Validation, streamå‡¦ç†ãªã©ãŒã§ãã‚‹ã€‚
- Node.js
  - JavaScriptã®å®Ÿè¡Œç’°å¢ƒã€‚GraphAIã®nodeã¨æ··åŒã—ãã†ãªã®ã§ã€Node.jsã¨è¡¨è¨˜ã—ã¾ã™ã€‚
  
## Graphãƒ‡ãƒ¼ã‚¿ã®ä½œã‚Šæ–¹

### echoAgentã‚’ä½¿ã£ãŸç°¡å˜ãªGraphã®ä½œæˆ

echoAgent(æŒ‡å®šã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹Agent)ã‚’ä½¿ã£ã¦ã€ç°¡å˜ãªGraphãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚
GraphAIã®Graphãƒ•ã‚¡ã‚¤ãƒ«ã®å¿…é ˆé …ç›®ã¯versionã¨nodesã§ã™ã€‚

versionã¯ã€0.5ã‚’æŒ‡å®šã—ã¾ã™ã€‚(2024/06ç¾åœ¨)

nodesã¯ã€GraphAIã§ä½¿ã†å„ãƒãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚
ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯nodesã«echoAgentã‚’ä½¿ã£ãŸï¼‘ã¤ã®nodeã‚’è¿½åŠ ã—ã¾ã™ã€‚
echoAgentã¯paramsã§æŒ‡å®šã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ã‹ã‚‰ã®å…¥åŠ›å€¤ã‚’ãã®ã¾ã¾è¿”ã™Agentã§ã™ã€‚

è¿½åŠ ã™ã‚‹nodeã¯ã€node1ã¨ã„ã†Nodeåã‚’ã¤ã‘ã¾ã™ã€‚
ã“ã®nodeã¯`message: hello`ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã®YAMLã¯ï¼‘ã¤ã—ã‹nodeãŒã‚ã‚Šã¾ã›ã‚“ãŒã€çµæœã‚’è¿”ã™nodeã¯node1ãªã®ã§ã€`isResult: true`ã‚’è¿½åŠ ã—ã€ã“ã®nodeã®çµæœãŒã“ã®Graphã®çµæœã¨æŒ‡å®šã—ã¾ã™ã€‚


```yaml
version: 0.5
nodes:
  node1: 
    params:
      message: hello
    agent: echoAgent
    isResult: true
   
```

ã“ã‚Œã‚’echo.yamlã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã§ä¿å­˜ã—ã¦ã€graphaiã®cliã§å®Ÿè¡Œã—ã¾ã™

```shell-session
$ graphai echo.yaml 
{ node1: { message: 'hello' } }
```

2è¡Œç›®ã®`message: hello`ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°æˆåŠŸã§ã™ã€‚

### inputsã‚’è¿½åŠ ã™ã‚‹

æ¬¡ã«è¤‡æ•°ã®Agentã‚’çµ„ã¿åˆã‚ã›ã€inputsã§å…¥åŠ›ã‚’æŒ‡å®šã—ãŸYAMLã‚’ä½œã‚Šã¾ã™ã€‚
å…¥åŠ›ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ä¾å­˜é–¢ä¿‚ãŒå®šç¾©ã§ãã€ãã‚Œã«ã‚ˆã£ã¦å®Ÿè¡Œé †ãŒåˆ¶å¾¡ã•ã‚Œã¾ã™ã€‚

bypassAgentã¯å…¥åŠ›å€¤ã‚’ãã®ã¾ã¾å‡ºåŠ›å€¤ã§è¿”ã™Agentã§ã™ã€‚
å…ˆç¨‹ã®echoAgentã®yamlã«node2ã‚’è¿½åŠ ã—ã¾ã™ã€‚node2ã®agentã¯bypassAgentã‚’æŒ‡å®šã—ã¾ã™ã€‚
å…¥åŠ›ã®inputsã¨ã—ã¦ã€å‰ã®node1ã‚’æŒ‡å®šã—ã¾ã™ã€‚inputsã¯æ–‡å­—åˆ—ã®é…åˆ—ã§ã€nodeåã‚’æŒ‡å®šã—ã¾ã™ã€‚

ä»Šå›ã¯å‡ºåŠ›ã¯bypassAgentã®node2ãªã®ã§ã€node2ã«`isResult: true`ã‚’æŒ‡å®šã—ã¾ã™ã€‚node1ã®isResultã¯å‰Šé™¤ã—ã¾ã™ã€‚

```yaml
version: 0.5
nodes:
  node1: 
    params:
      message: hello
    agent: echoAgent
  node2: 
    agent: bypassAgent
    inputs: [":node1"]
    isResult: true
```

å®Ÿè¡Œã•ã‚Œã‚‹é †ã«èª¬æ˜ã™ã‚‹ã¨ã€
- node1ã®echoAgentãŒå®Ÿè¡Œã•ã‚Œã€paramsã®å€¤ã‚’çµæœã¨ã—ã¦è¿”ã™
- node1ã‚’å…¥åŠ›ã¨ã—ã¦ã„ã‚‹nodeã€node2ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚node2ã®å…¥åŠ›å€¤ã¯node1ã®å®Ÿè¡Œçµæœã§ã€ãã‚Œã‚’å…¥åŠ›ã¨ã—ã¦ã†ã‘ã¨ã‚‹ã€‚node2ã®bypassAgentã¯å…¥åŠ›å€¤ã‚’ãã®ã¾ã¾çµæœã¨ã—ã¦è¿”ã™agentãªã®ã§ã€node1ã®çµæœã‚’ãã®ã¾ã¾è¿”ã™ã€‚

ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨node2ã®çµæœã¨ã—ã¦`message: 'hello'`ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
ã¾ãŸçµæœã¯arrayã«ãªã£ã¦ã„ã¾ã™ã€‚

```shell-session
 $ graphai echo2.yaml
{ node2: [ { message: 'hello' } ] }
```

åŒã˜ã‚ˆã†ã«ã€ä»Šåº¦ã¯å…¥åŠ›ã‚’å¢—ã‚„ã—ã¦è©¦ã—ã¦ã¿ã¾ã™ã€‚
node1ã¨åŒã˜echoAgentã‚’node2ã¨ã—ã€bypassAgentã‚’node3ã«ã—ã¾ã™ã€‚

å…¥åŠ›ã®inputsã¯ä»Šåº¦ã¯` ["node1", "node2"]`ã¨ï¼’ã¤æŒ‡å®šã—ã¾ã™ã€‚

node3ãŒ`isResult: true`ã§ã™ã€‚

```yaml
version: 0.5
nodes:
  node1: 
    params:
      message: hello
    agent: echoAgent
  node2: 
    params:
      message: ã“ã‚“ã«ã¡ã¯
    agent: echoAgent
  node3: 
    agent: bypassAgent
    inputs: ["node1", "node2"]
    isResult: true
```

```shell-session
$ graphai echo3.yaml
{ node3: [ { message: 'hello' }, { message: 'ã“ã‚“ã«ã¡ã¯' } ] }
```

node3ã®çµæœã¨ã—ã¦ã€ï¼’ã¤ã®å…¥åŠ›å€¤ãŒãã®ã¾ã¾å‡ºåŠ›ã•ã‚Œã¾ã™

ã“ã®ã‚ˆã†ã«inputsã‚’ä½¿ã£ã¦ã€è¤‡æ•°ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ã¤ãªã’ã¦ã„ãã“ã¨ãŒã§ãã¾ã™ã€‚

inputsã‚’æŒã¤agentã¯ã€å…¥åŠ›ã¨ãªã‚‹node1, node2ã®agentã®å®Ÿè¡Œçµæœã‚’å¾…ã£ã¦ã‹ã‚‰å®Ÿè¡Œã—ã¾ã™ã€‚
å…¥åŠ›ã®agentãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ãŸã‚Šã€APIã‚’å©ãã‚ˆã†ãªæ™‚é–“ã®ã‹ã‹ã‚‹å‡¦ç†ã®å ´åˆã§ã‚‚ã€ãã®å‰ã®å‡¦ç†ãŒçµ‚ã‚ã‚‹ã®ã‚’å¾…ã£ã¦ã‹ã‚‰å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

## Agentã®document

å„Agentã®[AgentFunctionInfo](https://github.com/receptron/graphai/blob/ee6878a4cd1d453c0729ee7ffcad63f073427b64/packages/graphai/src/type.ts#L118-L140)ã«æ›¸ã‹ã‚ŒãŸæƒ…å ±ã‚’å…ƒã«ã€æ©Ÿæ¢°çš„ã«ç”Ÿæˆã—ãŸdocumentãŒ[AgentDoc](https://github.com/receptron/graphai/blob/main/docs/agentDocs/README.md)ã«ã‚ã‚Šã¾ã™ã€‚


## AgentFunctionInfoã«ã¤ã„ã¦

npmã§é…å¸ƒã•ã‚Œã‚‹agentã¯ã€å®Ÿè¡Œã•ã‚Œã‚‹agentã®é–¢æ•°ã¨ã€ãã®Agentã®æƒ…å ±ã‚’å«ã‚€[AgentFunctionInfo](https://github.com/receptron/graphai/blob/ee6878a4cd1d453c0729ee7ffcad63f073427b64/packages/graphai/src/type.ts#L118-L140)ã®å½¢å¼é…å¸ƒã•ã‚Œã¾ã™ã€‚

AgentFunctionInfoã«ã¯ã€Agentã®æƒ…å ±(nameã‚„description)ã€ã‚µãƒ³ãƒ—ãƒ«ã®å…¥å‡ºåŠ›ã€å…¥åŠ›ã®ã‚¹ã‚­ãƒ¼ãƒãªã©ã®æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚Sampleã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è‡ªå‹•ç”Ÿæˆã‚„Unit testã«ã‚‚ä½¿ã‚ã‚Œã¾ã™ã€‚

Agentã‚’ä½œæˆã—ã¦GraphAIã§åˆ©ç”¨ã™ã‚‹ã¨ãã¯ã€AgentFunctionInfoã‚’ä½œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

(* ç°¡æ˜“çš„ã«agentã‚’å³æ™‚é–¢æ•°ã§ä½¿ã†æ–¹æ³•ã‚„ã€AgentFunctionInfoã®ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã†ãªã©ã€é–‹ç™ºæ™‚ã«ã¯çœç•¥ã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚åˆ¥é€”èª¬æ˜äºˆå®šï¼‰


## Agentã®é–‹ç™ºæ–¹æ³•


GraphAIã§ä½¿ã†Agentã®ä½œã‚Šæ–¹ã®èª¬æ˜ã‚’ã—ã¾ã™ã€‚

ã“ã¡ã‚‰ã®ã‚µãƒ³ãƒ—ãƒ«ã®agentã®ãƒ¬ãƒã‚¸ãƒˆãƒªãŒã‚ã‚Šã¾ã™ã€‚
https://github.com/isamu/graphai_agent_template

Agentã¯ã€Agentã®æœ¬ä½“ã¨ãã‚Œã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã§æ§‹æˆã•ã‚Œã¾ã™ã€‚
Agentã®æœ¬ä½“ã‚’src/ä»¥ä¸‹(ä»Šå›ã¯[src/sample_agent.ts](https://github.com/isamu/graphai_agent_template/blob/master/src/sample_agent.ts)), Agentã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’test/ä»¥ä¸‹(ä»Šå›ã¯[tests/test_agent.ts](https://github.com/isamu/graphai_agent_template/blob/master/tests/test_agent.ts))ã«ä½œã‚Šã¾ã™ã€‚

ä»Šå›ä½œæˆã™ã‚‹Agentã¯`SampleAgent`ã¨ã„ã†åå‰ã§ã™ã€‚
å‹•ä½œã¯ã€GraphAIã‹ã‚‰ã®å…¥åŠ›å€¤(è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®params)ã®`params`ã¨ã€å‰ã®agentã‹ã‚‰ã®å…¥åŠ›å€¤`inputs`ã€ã“ã®ï¼’ã¤ã®å€¤ã‚’mergeã—ã¦objectã¨ã—ã¦è¿”ã™ç°¡å˜ãªAgentã§ã™ã€‚

#### Agent

Agentã®æœ¬ä½“ã¯ã“ã¡ã‚‰ã§ã™ã€‚

```typescript
import { AgentFunction } from "graphai";

export const sampleAgent: AgentFunction = async ({ params, inputs }) => {
  return { params, inputs };
};
```

Agentã¯å¿…ãš`AgentFunction`ã®å‹ã§ã€éåŒæœŸ(`async`)ãªé–¢æ•°ã§ã™ã€‚
æœ€åˆã®èª¬æ˜ã«ã‚ã£ãŸã‚ˆã†ã«ã€`params`ã¨å…¥åŠ›ã‚’ã¨ã£ã¦ã€ãã‚Œã‚’è¿”ã™ã ã‘ã®ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚

ã©ã‚“ãªAgentã‚‚åŸºæœ¬çš„ã«ã¯ã“ã®ã‚ˆã†ã«å…¥åŠ›å€¤ã‚’å—ã‘å–ã£ã¦ã€ä½•ã‚‰ã‹ã®çµæœã‚’è¿”ã™ï¼‘ã¤ã®é–¢æ•°ã§ã™ã€‚

#### AgentFunctionInfo

Agentã¯ã€AgentFunctionInfoã®å‹ã®ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦GraphAIã«ã‚ãŸã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
AgentFunctionInfoã¯Agentæœ¬ä½“ã¨inputs/params/resultã®ã‚µãƒ³ãƒ—ãƒ«ã®å€¤ã€Agentã®ãƒ¡ã‚¿æƒ…å ±ã‚’å«ã¿ã¾ã™ã€‚

[src/sample_agent.ts](https://github.com/isamu/graphai_agent_template/blob/master/src/sample_agent.ts)ã«è¿½åŠ ã—ã¾ã™ã€‚

```
// for test and document
```
ä»¥ä¸‹ã«ãƒ†ã‚¹ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«å€¤ã¨ã€ã“ã®Agentã®æƒ…å ±(`AgentFunctionInfo`)ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚
ã“ã‚Œã‚‰ã‚’sampleAgentInfoã«ã¾ã¨ã‚ã¦`export`ã—ã¾ã™ã€‚

ã‚µãƒ³ãƒ—ãƒ«å€¤ã¯Unit Test(ã¤ã¾ã‚Šã€ã‚µãƒ³ãƒ—ãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨Unit Testã®ä¸¡æ–¹ã‚’å…¼ã­ã¦ã„ã¾ã™ï¼‰ã§ä½¿ã„ã¾ã™ã€‚
å¾Œè¿°ã™ã‚‹é–‹ç™ºæ™‚ã«ã¯ã“ã®ã‚µãƒ³ãƒ—ãƒ«å€¤ã‚’ä½¿ã£ã¦TestRunnerã§ãƒ†ã‚¹ãƒˆã‚’ã—ã¾ã™ã€‚

Agentã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€agentã‚’å«ã‚€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±(`AgentFunctionInfo`)ã‚’`defaule export`ã—ã¾ã™ã€‚

```typescript
import { AgentFunctionInfo } from "graphai";

const sampleInput = [{message: "hello"}, {message: "test"}];
const sampleParams = { sample: "123" };
const sampleResult = { inputs: sampleInput, params: sampleParams };

const sampleAgentInfo: AgentFunctionInfo = {
  name: "sampleAgent",
  agent: sampleAgent,
  mock: sampleAgent,
  inputs: {
    type: "array",
  },
  samples: [
    {
      inputs: sampleInput,
      params: sampleParams,
      result: sampleResult,
    },
  ],
  description: "Sample agent",
  author: "isamu arimoto",
  repository: "https://github.com/isamu/graphai_doc",
  license: "MIT",
};

export default sampleAgentInfo;

```

è¤‡æ•°ã®ã‚µãƒ³ãƒ—ãƒ«å€¤ã‚’ç”¨æ„ã™ã‚‹å ´åˆã¯

```typescript
  samples: [
    {
      inputs: sampleInput,
      params: sampleParams,
      result: sampleResult,
    },
    {
      inputs: sampleInput2,
      params: sampleParams2,
      result: sampleResult2,
    },
  ],
```
ã¨ã—ã¾ã™ã€‚
è¤‡æ•°ã®ã‚µãƒ³ãƒ—ãƒ«å€¤ãŒã‚ã‚‹ã¨ãã¯ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã¯å…¨ã¦ã®ã‚±ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

#### Unit Test

Agentã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æƒ…å ±ã‚’ä½¿ã£ã¦Agentå˜ä½“ã®Unit Testã‚’ã—ã¾ã™ã€‚
GraphAIã«å«ã¾ã‚Œã‚‹agentTestRunnerã«sampleAgentInfoã‚’æ¸¡ã—ã¦Unit Testã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
agentTestRunnerã¯ã€sampleAgentInfoã«å«ã¾ã‚Œã‚‹ã‚µãƒ³ãƒ—ãƒ«å€¤ã‚’ä½¿ã£ã¦Agentã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
ã“ã®é–¢æ•°ã¯ã€å†…éƒ¨ã§`node:test`ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚
inputs, paramsã®ãƒšã‚¢ã‚’ä½¿ã£ã¦Agentã‚’å®Ÿè¡Œã€çµæœã¨resultãŒä¸€è‡´ã™ã‚Œã°ãƒ†ã‚¹ãƒˆã¯æˆåŠŸã§ã™ã€‚

```typescript
import sampleAgentInfo from "@/sample_agent";
import { agentTestRunner } from "@receptron/test_utils";

agentTestRunner(sampleAgentInfo);
```

package.jsonã«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚ã‚‹ã®ã§

```sh
yarn run test
```

ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

#### é–‹ç™º

æœ€åˆã«Agentã‚’é–‹ç™ºã™ã‚‹ã¨ãã€ã“ã®[ãƒ¬ãƒã‚¸ãƒˆãƒª](https://github.com/isamu/graphai_agent_template)ã‚’forkã—ã¦ä½¿ã†ã¨è‰¯ã„ã§ã™ã€‚
Agentä½œæˆã«å¿…è¦ãªè¨­å®šã¯ `package.json`, `eslintrc.js`, `.prettierrc`, `tsconfig.json` ã«è¨­å®šæ¸ˆã¿ã§ã™

`src/sample_agent.ts`ã‚’ãƒ™ãƒ¼ã‚¹ã«å¿…è¦ãªå®Ÿè£…ã‚’è¿½åŠ ã—ã¦ã„ãã€æœŸå¾…ã™ã¹ã`samples`ã‚’æ›´æ–°ã€è¿½åŠ ã—ãªãŒã‚‰Unit Testã‚’å‹•ã‹ã—ã¾ã™ã€‚
Unit Testã‚’Passã—ã€æœŸå¾…ã™ã¹ãå‹•ä½œãŒã™ã‚‹ã‚ˆã†ã«ãªã‚Œã°Agentã¯å®Œæˆã§ã™ã€‚


#### Agentã®å—ã‘å–ã‚‹ãƒ‡ãƒ¼ã‚¿

sampleAgentã§ã¯ã€Agentã®é–¢æ•°ã§`{ params, inputs }`ã‚’å—ã‘å–ã‚Šã¾ã—ãŸã€‚
å®Ÿéš›ã¯`AgentFunctionContext`ã®æƒ…å ±ã‚’å—ã‘å–ã£ã¦ã„ã¾ã™ã€‚

- params
  - GraphDataã®yaml/jsonã®paramsã§ä¸ãˆã‚‰ã‚Œã‚‹å€¤
- inputs
  - GraphDataã®inputsã§æŒ‡å®šã•ã‚Œã‚‹å€¤ã€‚å‰ã«å®Ÿè¡Œã—ãŸAgentã®çµæœã‚„ã€static nodeã§ã®å€¤ã€inputsã«æ›¸ã‹ã‚ŒãŸå€¤ãªã©ã€‚
  - inputsã¯Arrayã§ã€å…¥åŠ›ã®æ•°ã¨åŒã˜é•·ã•ã€‚
- namedInputs
   - inputsã®object(dictonary)æ™‚
   
åŸºæœ¬çš„ã«ã¯ã“ã®ã†ã¡ã®ï¼’ã¤(paramsã¨(inputs or namedInputs))ã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã‚Šã€Agentã®å‡¦ç†ã‚’ã—ã¾ã™ã€‚çµæœã¯returnã§è¿”ã—ã¾ã™ã€‚
Agentã®çµæœã¯ã€æ¬¡ã«å®Ÿè¡Œã•ã‚Œã‚‹Agentã®inputsãªã©ã§åˆ©ç”¨ã•ã‚Œã¾ã™ã€‚(inputã®è¨˜è¿°æ–¹æ³•ã¯åˆ¥é€”è§£èª¬ã—ã¾ã™)

inputsã¨inputsã¯GraphDataã§
- `inputs: [":node1", ":node2"]` ã¨arrayã«ã—ãŸå ´åˆã¯inputs,
- `inputs: {v1: ":node1", v2: ":node2"}` ã¨ã—ãŸå ´åˆã«ã¯objectã§namedInputs
ãŒæ¸¡ã•ã‚Œã¾ã™ã€‚åŒæ™‚ã«ï¼’ã¤ãŒãã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

- agentFilters
  - AgentFilterã¨ã„ã†ä»•çµ„ã¿ã‚’ä½¿ã†å ´åˆã«ä½¿ã†
- debugInfo
  - debugæ™‚ãªã©ã«å¿…è¦ãªæƒ…å ±

ã§ã€ãã‚Œä»¥å¤–ã¯NestedGraphã§ä½¿ã†ç‰¹åˆ¥ãªãƒ‡ãƒ¼ã‚¿ãªã®ã§ã€é€šå¸¸ã¯åˆ©ç”¨ã—ã¾ã›ã‚“ã€‚


## Agentã®documentç”Ÿæˆã¨ãƒ†ã‚¹ãƒˆ

AgentFunctionInfoã«å«ã¾ã‚Œã‚‹æ–¹æ³•ã‚’ä½¿ã£ã¦ã€agentã®unit testã‚’å®Ÿè¡Œã™ã‚‹ã€documentã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

Test runnerã¯ã€`@receptron/test_utils`ã«å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
```typescript
import { agentTestRunner } from "@receptron/test_utils";

const main = async () => {
  await agentTestRunner(agentFunctionInfo);
};

main();
```

Documentã®è‡ªå‹•ç”Ÿæˆã¯ã“ã¡ã‚‰ã‚’å‚è€ƒã«ã€‚ä»Šå¾Œã€åˆ©ç”¨ã—ã‚„ã™ã„å½¢å¼ã§æä¾›äºˆå®šã§ã™ã€‚

https://github.com/receptron/graphai/blob/main/packages/cli/src/docs.ts



## AgentFilter

AgentFilterã¯ã€ãã‚Œãã‚Œã®Computed NodeãŒå®Ÿè¡Œã•ã‚Œã‚‹å‰ã«ã€ãªã«ã‹ã®å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

[@graphai/agent_filters](https://www.npmjs.com/package/@graphai/agent_filters)ã§ã¯httpã®streamã®ãŸã‚ã®filterã‚„ã€AgentFunctionInfoã®input schemaã‚’ä½¿ã£ãŸå…¥åŠ›å€¤ã®validateã‚’è¡Œã†agent filterãŒã‚ã‚Šã¾ã™ã€‚


### namedInput Validator

namedInputã®å€¤ã‚’agentFunctionInfoã®input schemaã®æƒ…å ±ã‚’å…ƒã«validationã—ã¾ã™

Testã‚³ãƒ¼ãƒ‰ã§ã®åˆ©ç”¨ä¾‹
https://github.com/isamu/graphai/blob/agentFilter/packages/agent_filters/tests/validation/test_agent_namedinput_validator.ts

```typescript
import { GraphAI } from "graphai";
import * as agents from "@graphai/agents";
import { namedInputValidatorFilter } from "@graphai/agent_filters";

const agentFilters = [
  {
    name: "namedInputValidatorFilter",
    agent: namedInputValidatorFilter,
  },
];

const graph = new GraphAI(graph_data, agents, { agentFilters });
const results = await graph.run();

```

### streamAgentFilterGenerator

filterParamsã®streamTokenCallbacké–¢æ•°ã‚’é€šã—ã¦streamã®ãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡ã—ã¾ã™ã€‚
ã‚µãƒ¼ãƒã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

#### server ä¾‹

https://github.com/receptron/graphai_utils/blob/main/packages/express/src/express.ts

express server
```typescript
    return async (req: express.Request, res: express.Response) => {
      res.setHeader("Content-Type", "text/event-stream;charset=utf-8");
      res.setHeader("Cache-Control", "no-cache, no-transform");
      res.setHeader("X-Accel-Buffering", "no");

      const callback = (context: AgentFunctionContext, token: string) => {
        if (token) {
          res.write(token);
        }
      };
      const streamAgentFilter = {
        name: "streamAgentFilter",
        agent: streamAgentFilterGenerator<string>(callback),
      };
      const agentFilters = [streamAgentFilter]

      const agentFilterRunner = agentFilterRunnerBuilder(agentFilters);
      const result = await agentFilterRunner(context, agent.agent);

      const json_data = JSON.stringify(result);
      res.write("___END___");
      res.write(json_data);
      return res.end();
   }
```

### web client

https://github.com/isamu/graphai-stream-web/blob/main/src/views/Home.vue

```typescript
const useAgentFilter = (callback: (context: AgentFunctionContext, data: T) => void) => {
  const streamAgentFilter = streamAgentFilterGenerator(callback);

  const agentFilters = [
    {
      name: "streamAgentFilter",
      agent: streamAgentFilter,
      agentIds: streamAgents,
    },
  ];
  return agentFilters;
};   

export default defineComponent({
  setup() {
    const streamingData = ref<Record<string, unknown>>({});

    const callback = (context: AgentFunctionContext, data: string) => {
      const { nodeId } = context.debugInfo;
      streamingData.value[nodeId] = (streamingData.value[nodeId] ?? "") + data;
    };
    const agentFilters = useAgentFilter(callback);
    
    const graphai = new GraphAI(graphData, agents, { agentFilters });
  }
})
```

### httpAgentFilter

ã‚°ãƒ©ãƒ•ã®ãƒ•ãƒ­ãƒ¼ã§ã€agentã®å®Ÿè¡Œã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã€httpçµŒç”±ã§ã‚µãƒ¼ãƒã®agentã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
Webã§ã®ã‚µãƒ³ãƒ—ãƒ«ã¯ã“ã¡ã‚‰ã«ã‚ã‚Šã¾ã™ã€‚

https://github.com/isamu/graphai-stream-web/blob/main/src/views/Home.vue


### agentFilterRunnerBuilder

GraphAIã‚’ä½¿ã‚ãªã„ã§agentFilterã¨agentã‚’å‹•ã‹ã™Runnerã§ã™ã€‚
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã‚µãƒ¼ãƒã®agentã‚’å‘¼ã³å‡ºã™ã¨ãã«ã€ã‚µãƒ¼ãƒå´ã§ä½¿ã„ã¾ã™ã€‚
agentFilterã‚„agentã®å˜ä½“ãƒ†ã‚¹ãƒˆã§ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

expressã¨testæ™‚ã®ã‚µãƒ³ãƒ—ãƒ«ã¯ã“ã¡ã‚‰ã€‚

express
https://github.com/receptron/graphai_utils/blob/main/packages/express/src/express.ts

test
https://github.com/isamu/graphai/blob/agentFilter/packages/agent_filters/tests/filters/test_filter_runner.ts

### é–¢é€£ãƒ¬ãƒã‚¸ãƒˆãƒª

# GraphAI visual programing

https://github.com/isamu/graphai-litegraph/

# GraphAI Python Agent server

https://github.com/isamu/graphai_python_server

# GraphAI PlayGround

https://github.com/receptron/graphai-playground

<!-- ## é€éçš„ã«ã‚µãƒ¼ãƒ/ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½¿ã† -->
<!-- T.B.D -->






